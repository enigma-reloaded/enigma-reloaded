(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{128:function(e,t,n){},129:function(e,t,n){},133:function(e,t){},136:function(e,t){},267:function(e,t,n){"use strict";n.r(t);n(128),n(129);var c=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function r(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}n(130),n(131);var a=n(9),s=n(1),i=n.n(s),l=n(12),o=n(38),u=n(30),d=n(4),j=Object(d.a)({});function b(e){var t=Object(d.c)(j);Object(s.useEffect)((function(){void 0===t[e].get()&&u.getItem(e).then((function(n){t.merge(Object(o.a)({},e,n))}))}),[e,t]);var n=t[e].get();return void 0===n&&(n="NOT_READY"),[n,function(n){t.merge(Object(o.a)({},e,n)),u.setItem(e,n)}]}var p=n(20);var m=n(6),h=n(121),f=n(2),O=n.n(f),x=n(3),g=n(41),v=n(42),y=n(44),w=n(43);function N(e){w.b.error(e)}var k,E=function(){function e(t,n){Object(g.a)(this,e),this.secret=t,this.storage=n}return Object(v.a)(e,[{key:"encrypt",value:function(e,t){if("object"===typeof t)t=JSON.stringify(t);else if("number"===typeof t)t=t.toString();else if("string"!==typeof t)throw new Error("invalid type");var n,c=y.AES.encrypt(t,this.secret);try{n=this.storage.setItem(e,c.toString())}catch(r){throw N("Unable to save more data"),r}return n}},{key:"decrypt",value:function(){var e=Object(x.a)(O.a.mark((function e(t){var n,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.getItem(t);case 2:if(n=e.sent,c=null,n){c=y.AES.decrypt(n,this.secret).toString(y.enc.Utf8);try{c=JSON.parse(c)}catch(r){}}return e.abrupt("return",c);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"remove",value:function(e){return this.storage.removeItem(e)}}]),e}(),I=Object(d.a)({privateKey:null,publicKey:null});function C(){var e=Object(d.c)(I);return{privateKey:e.privateKey.get(),publicKey:e.publicKey.get(),setKeyPair:function(e){var t=e.publicKey,n=e.privateKey;I.merge({privateKey:n,publicKey:t})}}}function P(e){return k?k.decrypt(e):null}function S(e){if(!k)throw new Error("Pin not set");return k.storage.removeItem(e)}function D(e,t){if(!k)throw new Error("Pin not set");return k.encrypt(e,t)}function K(e){k=new E(e,u)}function M(){return A.apply(this,arguments)}function A(){return(A=Object(x.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={},e.next=3,k.storage.iterate((function(e,n){t[n]=e}));case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(){k=null,I.merge({privateKey:null,publicKey:null})}window.localforage=u;var V=n(0);function F(e){var t=e.title,n=e.children;return Object(V.jsxs)("div",{className:"p-2 bg-gray-300 rounded my-2",children:[Object(V.jsx)("div",{className:"italic font-bold",children:t}),Object(V.jsx)("div",{className:"pt-2",children:n})]})}var T=n.p+"static/media/example.87b40669.mp4";function B(){return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsxs)("div",{className:"w-full md:w-1/2",children:[Object(V.jsx)("div",{className:"font-bold text-3xl",children:"Engima Reloaded"}),Object(V.jsxs)("div",{className:"mt-12",children:[Object(V.jsx)("div",{className:"font-bold mb-2",children:"Features"}),Object(V.jsx)("div",{className:"pl-4",children:Object(V.jsxs)("ul",{className:"list-disc",children:[Object(V.jsx)("li",{children:"DIY Encrypt and decrypt messages and files"}),Object(V.jsxs)("li",{children:[Object(V.jsx)("a",{href:"https://github.com/enigma-reloaded/enigma-reloaded/blob/master/LICENSE",target:"_blank",className:"underline",children:"Open source license(GPL V3)"})," and ",Object(V.jsx)("a",{href:"https://github.com/enigma-reloaded/enigma-reloaded",target:"_blank",className:"underline",children:"open source code"})]}),Object(V.jsxs)("li",{className:"mt-2",children:["Local data such as contacts and messages are encrypted using ",Object(V.jsx)("b",{children:"AES-256"}),", and your PIN is used as the passphrase"]}),Object(V.jsxs)("li",{className:"my-2",children:["Messages and files are encrypted using ",Object(V.jsx)("b",{children:"Public-key authenticated encryption (box)"})," from ",Object(V.jsx)("a",{className:"underline",href:"https://github.com/dchest/tweetnacl-js",target:"_blank",children:"https://github.com/dchest/tweetnacl-js"}),". Which is implements ",Object(V.jsx)("b",{children:"x25519-xsalsa20-poly1305"})]}),Object(V.jsx)("li",{children:"No ads, tracking, remote server"}),Object(V.jsx)("li",{children:"Offline support"}),Object(V.jsxs)("li",{children:["Compatible with services such as: ",Object(V.jsx)("b",{children:"Messenger, Signal, Slack, Whatsapp, Twitter, Instagram DM, SMS etc"}),". You can even print the cypher on a paper"]}),Object(V.jsxs)("li",{children:["Import export ",Object(V.jsx)("b",{children:"encrypted backups"})]})]})})]})]}),Object(V.jsx)("div",{className:"py-4",children:Object(V.jsx)("a",{href:"https://github.com/enigma-reloaded/enigma-reloaded/blob/master/why-not-pgp.md",target:"_blank",className:"underline text-xl",children:'Answer for: "Why not use PGP, instead of this?"'})}),Object(V.jsxs)("div",{children:[Object(V.jsx)("div",{className:"font-bold mb-2",children:"Demo:"}),Object(V.jsxs)("div",{className:"md:w-2/3 w-full mx-auto",children:[Object(V.jsx)("video",{className:"w-full",controls:!0,children:Object(V.jsx)("source",{src:T,type:"video/mp4"})}),Object(V.jsxs)("div",{className:"italic text-right text-xs",children:[Object(V.jsx)("p",{children:'Credits for Music: www.bensound.com" or "Royalty Free Music from Bensound'}),Object(V.jsx)("p",{children:"Chat app: stin.to"})]})]}),Object(V.jsx)("div",{children:"As you can see in the video, encrypted messages are just simple words, which you can send using existing technologies."})]}),Object(V.jsxs)("div",{className:"mt-12",children:[Object(V.jsx)("div",{className:"font-bold mb-2",children:"FAQ"}),Object(V.jsxs)(F,{title:"What is Enigma Reloaded?",children:["Enigma is a simple DIY(Do it yourself) program that runs inside your browser that helps you:",Object(V.jsx)("div",{className:"pl-4",children:Object(V.jsxs)("ul",{className:"list-disc",children:[Object(V.jsx)("li",{children:"Encrypt and decrypt messages"}),Object(V.jsx)("li",{children:"Encrypt and decrypt files"}),Object(V.jsx)("li",{children:"Store contacts and conversations"})]})})]}),Object(V.jsx)(F,{title:"Why is called Enigma?",children:Object(V.jsxs)("div",{children:["It's a common name that is already associated with secrecy and privacy, and your life should be private. Enigma reloaded single purpose is to help people ",Object(V.jsx)("a",{className:"underline",href:"https://www.youtube.com/watch?v=0hLjuVyIIrs",target:"_blank",children:"against the current Big Tech mass surveillance"})]})}),Object(V.jsx)(F,{title:"Can big tech claims about end to end encryption be trusted?",children:"No"}),Object(V.jsx)(F,{title:"Is it military grade secure?",children:Object(V.jsx)("div",{className:"pl-4",children:Object(V.jsxs)("ul",{className:"list-disc",children:[Object(V.jsx)("li",{children:"\u2713 Strong encryption"}),Object(V.jsx)("li",{children:"\u2713 Access control"}),Object(V.jsx)("li",{children:"\u2713 Encrypted backups"}),Object(V.jsx)("li",{children:"\u2713 No external services(except the optional gravatar for user avatars)"})]})})}),Object(V.jsxs)(F,{title:"Why did Enigma reloaded appear now?",children:[Object(V.jsx)("span",{className:"underline font-bold",children:"Free speech on the internet must have a real chance"})," against multi trillion dollar companies and governments which try to suppress it.",Object(V.jsx)("div",{children:"2021 might be the last year when internet is not 100% censored."})]}),Object(V.jsx)(F,{title:"Is it 'really' for free?",children:Object(V.jsxs)("div",{children:[Object(V.jsx)("div",{children:"100% free, no ads, no tracking. If Enigma Reloaded helped you, that's enough. But if you want, you can donate some Monero to the project"}),Object(V.jsx)("div",{className:"break-all py-2",children:Object(V.jsx)("b",{children:"866bdf5Dk8h2NdJBaukVpq9qwTjiiwRZWLE6e5yDXFRAcTCkozB3qDiiDoSvEQXBPhBKbXyzwxP88KkHEZBPsVui2NAKhVH"})})]})}),Object(V.jsx)(F,{title:"Can I self host it?",children:Object(V.jsx)("div",{children:Object(V.jsxs)("div",{children:["Sure, just ",Object(V.jsx)("a",{href:"https://github.com/enigma-reloaded/enigma-reloaded/archive/refs/heads/gh-pages.zip",target:"_blank",className:"underline",children:"download this zip file"})," and deploy it to your server."]})})})]})]})}var L=n.p+"static/media/enigma-logo.d8f45653.jpg";function W(e){var t=e.children;return Object(V.jsxs)("div",{children:[Object(V.jsx)("div",{className:"flex justify-center",children:Object(V.jsx)("img",{src:L,alt:"enigma"})}),Object(V.jsx)("div",{className:"py-2",children:t}),Object(V.jsx)(B,{})]})}var U=n(37),z=n.n(U),_=n(126);function H(e){var t=e.isOpened,n=e.close,c=e.children,r=Object(s.useMemo)((function(){return document.getElementById("modal-portal")}),[]);Object(s.useEffect)((function(){return t?document.body.classList.add("overflow-y-hidden"):document.body.classList.remove("overflow-y-hidden")}),[t]);var a=Object(s.useRef)(null);if(Object(_.a)(a,n),!t)return null;var i=Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-70"}),Object(V.jsx)("div",{className:"absolute inset-0 flex items-center py-20 overflow-y-auto px-2 md:px-0",children:Object(V.jsx)("div",{className:"md:mb-10 bg-white md:w-1/3 w-full p-4 rounded shadow mx-auto",ref:a,children:c})})]});return Object(U.createPortal)(i,r)}function J(){var e=b("pk-initialized"),t=Object(a.a)(e,2),n=(t[0],t[1]),c=Object(d.c)({confirmMatch:!0,confirmPinValue:"",emailValue:"",nameValue:"",passwordStrength:"Too weak",pinValue:"",setupPinModal:!1});var r=Object(m.isEmpty)(c.pinValue.get())||"Too weak"===c.passwordStrength.get()||Object(m.isEmpty)(c.confirmPinValue.get())||!c.confirmMatch.get();return Object(V.jsxs)("div",{children:[Object(V.jsx)(W,{children:Object(V.jsx)("div",{className:"flex justify-center",children:Object(V.jsx)("button",{onClick:function(e){e.preventDefault(),c.merge({setupPinModal:!0})},className:"bg-black text-white text-4xl rounded p-2",children:"Get started"})})}),Object(V.jsx)(H,{isOpened:c.setupPinModal.get(),close:function(e){e.preventDefault(),c.merge({setupPinModal:!1})},children:Object(V.jsx)("form",{className:"pure-form pure-form-aligned",onSubmit:function(e){e.preventDefault();var t=p.box.keyPair();K(c.pinValue.get()),D("key-pair",{publicKey:Array.from(t.publicKey),secretKey:Array.from(t.secretKey)}),D("name",c.nameValue.get()),D("email",c.emailValue.get().toLowerCase().replace(/\s/g,"")),n(!0)},children:Object(V.jsxs)("fieldset",{children:[Object(V.jsx)("legend",{children:"PIN setup"}),Object(V.jsxs)("div",{className:"pure-control-group",children:[Object(V.jsx)("input",{name:"name",value:c.nameValue.get(),onChange:function(e){c.merge({nameValue:e.target.value})},placeholder:"Enter your name",className:"w-full"}),Object(V.jsx)("span",{className:"pure-form-message",children:"Optional"})]}),Object(V.jsxs)("div",{className:"pure-control-group",children:[Object(V.jsx)("input",{type:"email",name:"email",value:c.emailValue.get(),onChange:function(e){c.merge({emailValue:e.target.value})},placeholder:"Your email to have a avatar from gravatar.com",className:"w-full"}),Object(V.jsx)("span",{className:"pure-form-message",children:"Optional"})]}),Object(V.jsxs)("div",{className:"pure-control-group",children:[Object(V.jsx)("input",{value:c.pinValue.get(),onChange:function(e){var t=e.target.value,n=Object(h.passwordStrength)(t).value;c.merge((function(c){return{confirmMatch:t===c.confirmPinValue,passwordStrength:n,pinValue:e.target.value}}))},placeholder:"Enter new PIN",className:"w-full",autoComplete:"nope",required:!0}),c.pinValue.get().length>0&&Object(V.jsx)("span",{className:"pure-form-message",children:c.passwordStrength.get()}),Object(V.jsxs)("span",{className:"pure-form-message",children:["You can't recover or change the PIN later. ",Object(V.jsx)("span",{className:"underline",children:"Make sure you remember it and keep it secret"})]})]}),Object(V.jsxs)("div",{className:"pure-control-group",children:[Object(V.jsx)("input",{value:c.confirmPinValue.get(),onChange:function(e){var t=e.target.value;c.merge((function(e){return{confirmMatch:t===e.pinValue,confirmPinValue:t}}))},placeholder:"Confirm your PIN",className:"w-full",autoComplete:"nope",required:!0}),!c.confirmMatch.get()&&Object(V.jsx)("span",{className:"pure-form-message text-red-500",children:"Pins don't match"})]}),Object(V.jsx)("button",{type:"submit",className:"pure-button pure-button-primary w-full",disabled:r,children:"Submit"})]})})})]})}function Y(e){var t=e.children,n=Object(l.g)(),c=Object(l.f)(),r=b("pk-initialized"),i=Object(a.a)(r,1)[0],o=null!==i,u="NOT_READY"===i;return Object(s.useEffect)((function(){u||o||"/"===n.pathname||c.push("/")}),[n,c,u,o]),u?null:o?t:Object(V.jsx)(J,{})}var q=n(75),G=n(127),Q=n(270);var X=n(13);function Z(){var e=Object(l.f)();return Object(V.jsxs)("div",{className:"my-2",children:[Object(V.jsx)("div",{className:"flex justify-center",children:Object(V.jsx)("img",{src:L,alt:"enigma"})}),Object(V.jsxs)("div",{className:"flex flex-wrap justify-center pt-2",children:[Object(V.jsx)($,{text:"Home",to:"/"}),Object(V.jsx)($,{text:"Contacts",to:"/contacts"}),Object(V.jsx)("div",{className:"pl-3",children:Object(V.jsx)("button",{className:"mx-1 text-center bg-black p-2 rounded text-white",onClick:function(t){t.preventDefault(),e.push("/unlock"),setTimeout(R,50)},children:"Lock"})})]})]})}function $(e){var t=e.text,n=e.to;return Object(V.jsx)(X.b,{to:n,children:Object(V.jsx)("button",{className:"mx-1 text-center bg-black p-2 rounded text-white",children:t})})}function ee(e){var t=e.children,n=function(){var e=Object(l.f)(),t=Object(l.g)(),n=C().publicKey,c=Object(s.useState)(!1),r=Object(a.a)(c,2),i=r[0],o=r[1],u=Object(Q.a)(12e4);return Object(s.useEffect)((function(){if(!n)return e.push("/unlock?redirectTo=".concat(t.pathname));o(!0)}),[n,o,e,t]),Object(s.useEffect)((function(){n&&u&&(e.push("/unlock?redirectTo=".concat(t.pathname)),setTimeout(R,50))}),[u,n,e,t.pathname]),i}();return Object(V.jsxs)("div",{children:[Object(V.jsx)("div",{children:Object(V.jsx)(Z,{})}),Object(V.jsxs)("div",{className:"min-h-screen flex flex-col justify-between",children:[n&&Object(V.jsx)("div",{children:t}),Object(V.jsx)("div",{className:"text-center pt-4",children:"Don't be evil"})]})]})}function te(e){var t=e.children,n=Object(G.a)(e,["children"]);return Object(V.jsx)(l.a,Object(q.a)(Object(q.a)({},n),{},{children:Object(V.jsx)(Y,{children:Object(V.jsx)(ee,{children:t})})}))}var ne=n(18),ce=document.title;function re(e){return e?"".concat(e," ").concat(ce):ce}function ae(e){var t=e.children;return Object(V.jsxs)(ne.b,{children:[Object(V.jsx)(ne.a,{children:Object(V.jsx)("title",{children:ce})}),t]})}function se(){return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(ne.a,{children:Object(V.jsx)("title",{children:re("About")})}),Object(V.jsx)(B,{})]})}function ie(e){var t=e.children;return Object(V.jsx)("div",{className:"p-4",children:t})}function le(e,t){var n=window.URL.createObjectURL(e),c=document.createElement("a");c.href=n,c.download=t,c.classList.add("hidden"),document.body.appendChild(c),c.click(),c.remove(),setTimeout((function(){window.URL.revokeObjectURL(e)}),1e3)}function oe(e){var t=Object(s.useState)(),n=Object(a.a)(t,2),c=n[0],r=n[1];Object(s.useEffect)((function(){P(e).then((function(e){r(e)}))}),[r,e]);return[c,function(t){r(t),D(e,t)}]}function ue(){var e=oe("name"),t=Object(a.a)(e,1)[0],n=Object(d.c)({buttonDisabled:!1});function c(){return(c=Object(x.a)(O.a.mark((function e(c){var r,a,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.preventDefault(),n.merge({buttonDisabled:!0}),e.next=4,M();case 4:r=e.sent,a=new Blob([JSON.stringify(r)]),s="".concat(t,"-enigma-backup.json"),le(a,s),n.merge({buttonDisabled:!1});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(V.jsxs)("div",{className:"mx-auto md:w-1/3 w-full",children:[Object(V.jsx)("div",{className:"py-4",children:Object(V.jsx)("button",{className:"pure-button pure-button-primary bg-black w-full",onClick:function(e){return c.apply(this,arguments)},disabled:n.buttonDisabled.get(),children:"Download backup"})}),Object(V.jsxs)("div",{children:[Object(V.jsx)("div",{className:"font-bold",children:"FAQ about backups"}),Object(V.jsx)(F,{title:"Can somebody restore my data with just the backup file?",children:"No, he needs the PIN"}),Object(V.jsxs)(F,{title:"What to do if someone got access to the program while it was PIN unlocked?",children:["Probably your ",Object(V.jsx)("a",{href:"https://en.wikipedia.org/wiki/Public-key_cryptography",target:"_blank",className:"underline",children:"Private Key"})," is compromised, you should start fresh and not from a backup."]})]})]})}function de(e){var t=document.createElement("input");t.setAttribute("value",e),document.body.appendChild(t),t.select();var n=document.execCommand("copy");return document.body.removeChild(t),n}function je(e){w.b.success(e)}function be(e){for(var t,n,c,r="",a=e.length,s=0;s<a;s++)t||(n=1,c=10,t=Math.floor(Math.random()*(c-n+1))+n),r+=e[s],(t-=1)||(r+=" ");return r}var pe=n(269),me=function(){function e(t){var n=t.id,c=t.messageRaw,r=t.encryptedMessage,a=t.contact,s=t.createdAt,i=t.mine;Object(g.a)(this,e),this.id=n,this.messageRaw=c,this.encryptedMessage=r,this.contact=a,this.createdAt=s,this.mine=i}return Object(v.a)(e,[{key:"copyToClipBoard",value:function(){de(be(this.encryptedMessage)),je("Encrypted message copied to clipboard")}},{key:"save",value:function(){var e=Object(x.a)(O.a.mark((function e(){var t,n,c=this;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.contact.messages.set((function(e){return e.splice(0,0,c),e})),t="private-messages-".concat(this.contact.id.get()),e.next=4,P(t);case 4:n=e.sent,Object(m.isEmpty)(n)&&(n=[]),n.splice(0,0,this.serialize()),D(t,n);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"serialize",value:function(){return{createdAt:this.createdAt,encryptedMessage:this.encryptedMessage.substring(0,8),id:this.id,messageRaw:this.messageRaw,mine:this.mine}}},{key:"destroy",value:function(){var e=Object(x.a)(O.a.mark((function e(t){var n,c,r,a=this;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.messages.findIndex((function(e){return e.id.get()===a.id})),c="private-messages-".concat(t.id.get()),e.next=4,P(c);case 4:r=(r=e.sent).filter((function(e){return e.id!==a.id})),t.messages.merge(Object(o.a)({},n,d.b)),D(c,r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function he(e,t,n){return fe.apply(this,arguments)}function fe(){return(fe=Object(x.a)(O.a.mark((function e(t,n,c){var r,a,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(new Date).toISOString(),a=Object(pe.a)(),!0,s=new me({contact:c,createdAt:r,encryptedMessage:n,id:a,messageRaw:t,mine:true}),e.next=6,s.save();case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(e,t,n){return xe.apply(this,arguments)}function xe(){return(xe=Object(x.a)(O.a.mark((function e(t,n,c){var r,a,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(new Date).toISOString(),a=Object(pe.a)(),!1,s=new me({contact:c,createdAt:r,encryptedMessage:n,id:a,messageRaw:t,mine:false}),e.next=6,s.save();case 6:return e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ge(e){return ve.apply(this,arguments)}function ve(){return(ve=Object(x.a)(O.a.mark((function e(t){var n,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="private-messages-".concat(t.id),e.next=3,P(n);case 3:if(c=e.sent,!Object(m.isEmpty)(c)){e.next=6;break}return e.abrupt("return",[]);case 6:return e.abrupt("return",c.map((function(e){var n=new me(e);return n.contact=t,n})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ye,we=function(){function e(t){var n=t.id,c=t.name,r=t.emailHash,a=t.publicKey;Object(g.a)(this,e),this.id=n,this.name=c,this.emailHash=r,this.publicKey=a,this.messages=[]}return Object(v.a)(e,[{key:"save",value:function(){return e=this,void P("contacts").then((function(t){Object(m.isEmpty)(t)&&(t=[]);var n=t.find((function(t){return t.publicKey===e.publicKey}));n?(Object.assign(n,e.serializeWithoutId()),Ne.contacts.find((function(t){return t.publicKey.get()===e.publicKey})).merge(e.serializeWithoutId())):(Ne.contacts.set((function(t){return t.splice(0,0,e),t})),t.splice(0,0,e.serialize())),D("contacts",t)}));var e}},{key:"destroy",value:function(){return function(e){return ke.apply(this,arguments)}(this)}},{key:"serialize",value:function(){return{emailHash:this.emailHash,id:this.id,name:this.name,publicKey:this.publicKey}}},{key:"serializeWithoutId",value:function(){var e=this.serialize();return delete e.id,e}},{key:"loadPrivateMessages",value:function(){var e=Object(x.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t.messages,e.next=3,ge(this);case 3:e.t1=e.sent,e.t0.set.call(e.t0,e.t1);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Ne=Object(d.a)({contacts:[]});function ke(){return(ke=Object(x.a)(O.a.mark((function e(t){var n,c,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P("contacts");case 2:if(n=e.sent,c=t.id,!Object(m.isEmpty)(n)){e.next=6;break}return e.abrupt("return");case 6:return n=n.filter((function(e){return e.publicKey!==t.publicKey})),void 0!==(r=Ne.contacts.findIndex((function(e){return e.publicKey.get()===t.publicKey})))&&Ne.contacts[r].set(d.b),e.next=11,D("contacts",n);case 11:return e.next=13,S("private-messages-".concat(c));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ee(){return Ie.apply(this,arguments)}function Ie(){return(Ie=Object(x.a)(O.a.mark((function e(){var t,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ye){e.next=2;break}return e.abrupt("return",Ne);case 2:return ye=!0,e.next=5,P("contacts");case 5:if(t=e.sent,!Object(m.isEmpty)(t)){e.next=8;break}return e.abrupt("return",Ne);case 8:return t=t.map((function(e){return new we(e)})),n=Object(m.sortBy)(t,"name"),Ne.merge({contacts:n}),e.abrupt("return",Ne);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ce(){return(Ce=Object(x.a)(O.a.mark((function e(t){var n,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ee();case 2:if(n=e.sent,(c=n.contacts.find((function(e){return e.id.get()===t}))).get()){e.next=6;break}return e.abrupt("return",{});case 6:return e.abrupt("return",new we(JSON.parse(JSON.stringify(c.get()))));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Pe=n.p+"static/media/user-placeholder.1bd594c3.svg";function Se(e){var t=e.emailHash,n=e.contact,c=e.height,r=e.width,s=b("gravatar-enabled"),i=Object(a.a)(s,1)[0];if("NOT_READY"===i)return null;var l,o=t||n.emailHash.get();return l=Object(m.isEmpty)(o)||!i?Pe:"http://www.gravatar.com/avatar/".concat(o),Object(V.jsx)("img",{src:l,className:"rounded-full ".concat(c," ").concat(r)})}function De(e){var t=e.contact,n=Object(d.c)({modalIsOpened:!1});function c(){n.merge({modalIsOpened:!1})}return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("button",{className:"underline",onClick:function(e){e.preventDefault(),n.merge({modalIsOpened:!0})},children:"Edit"}),Object(V.jsx)(H,{isOpened:n.modalIsOpened.get(),close:c,children:Object(V.jsxs)("form",{className:"pure-form pure-form-aligned",onSubmit:function(e){e.preventDefault(),c(),t.get().save(),je("Contact saved")},children:[Object(V.jsx)("fieldset",{children:Object(V.jsxs)("legend",{children:["Edit ",t.name.get()]})}),Object(V.jsx)("div",{className:"pure-control-group",children:Object(V.jsx)("input",{name:"name",value:t.name.get(),onChange:function(e){t.merge({name:e.target.value})},placeholder:"Name",className:"w-full",required:!0})}),Object(V.jsx)("button",{type:"submit",className:"pure-button pure-button-primary w-full bg-black",children:"Save"})]})})]})}var Ke,Me=n(27),Ae=n(19);function Re(e){if(!Object(m.isEmpty)(e))return Object(Ae.encodeBase64)(e).replace(/=/g,"")}function Ve(){return Fe.apply(this,arguments)}function Fe(){return(Fe=Object(x.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(m.isEmpty)(Ke)){e.next=2;break}return e.abrupt("return",Ke);case 2:return e.next=4,P("key-pair");case 4:if(t=e.sent,!Object(m.isEmpty)(t)){e.next=7;break}return e.abrupt("return");case 7:return e.abrupt("return",Ke=Uint8Array.from(t.secretKey));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Te(e,t){return Be.apply(this,arguments)}function Be(){return(Be=Object(x.a)(O.a.mark((function e(t,n){var c,r,a,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=Object(Ae.decodeBase64)(t),r=Object(Ae.decodeUTF8)(n),a=Object(p.randomBytes)(p.box.nonceLength),e.t0=p.box,e.t1=r,e.t2=a,e.t3=c,e.next=9,Ve();case 9:return e.t4=e.sent,s=(0,e.t0)(e.t1,e.t2,e.t3,e.t4),e.abrupt("return",Re(s)+Le(a));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Le(e){return Object(m.sample)(["?","!",".",","])+Re(e)}function We(e){var t=e.contact,n=Object(s.useRef)(),c=Object(d.c)({modalIsOpened:!1});Object(s.useEffect)((function(){c.modalIsOpened.get()&&n.current.focus()}),[c.modalIsOpened.get()]);var r=Object(s.useState)((function(){return Me.EditorState.createEmpty()})),i=Object(a.a)(r,2),l=i[0],o=i[1];function u(){return(u=Object(x.a)(O.a.mark((function e(n){var r,a,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),r=(r=Object(Me.convertToRaw)(l.getCurrentContent())).blocks.map((function(e){return e.text.trim()?e.text:"\n"})).join("\n"),e.next=5,Te(t.publicKey.get(),r);case 5:return a=e.sent,e.next=8,he(r,a,t);case 8:s=e.sent,c.merge({modalIsOpened:!1}),o(Me.EditorState.createEmpty()),s.copyToClipBoard();case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("button",{className:"pure-button pure-button-primary bg-black w-full",onClick:function(e){e.preventDefault(),c.merge({modalIsOpened:!0})},children:"Encrypt message"}),Object(V.jsx)(H,{isOpened:c.modalIsOpened.get(),close:function(){c.merge({modalIsOpened:!1})},children:Object(V.jsxs)("form",{onSubmit:function(e){return u.apply(this,arguments)},children:[Object(V.jsx)("div",{className:"border-gray-300 border border-solid p-2",children:Object(V.jsx)(Me.Editor,{editorState:l,onChange:o,placeholder:"Type your message",ref:n})}),Object(V.jsx)("div",{className:"flex justify-end my-2",children:Object(V.jsx)("button",{type:"submit",className:"pure-button pure-button-primary bg-black",disabled:!l.getCurrentContent().hasText(),children:"Encrypt message"})})]})})]})}function Ue(e){return Object(Ae.decodeBase64)(ze(e))}function ze(e){return e.length%4!==0&&(e+="===".slice(0,4-e.length%4)),e}function _e(e,t){return He.apply(this,arguments)}function He(){return(He=Object(x.a)(O.a.mark((function e(t,n){var c,r,s,i,l,o,u,d;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=n.split(/\?|!|\.|,/),r=Object(a.a)(c,2),s=r[0],i=r[1],!Object(m.isEmpty)(s)&&!Object(m.isEmpty)(i)){e.next=3;break}throw new Error("Invalid encrypted message");case 3:return l=Object(Ae.decodeBase64)(t),o=Ue(i),u=Ue(s),e.t0=p.box,e.t1=u,e.t2=o,e.t3=l,e.next=12,Ve();case 12:return e.t4=e.sent,d=e.t0.open.call(e.t0,e.t1,e.t2,e.t3,e.t4),e.abrupt("return",Object(Ae.encodeUTF8)(d));case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Je(e){var t=e.contact,n=Object(s.useRef)(),c=Object(d.c)({modalIsOpened:!1});Object(s.useEffect)((function(){c.modalIsOpened.get()&&n.current.focus()}),[c.modalIsOpened.get()]);var r=Object(s.useState)((function(){return Me.EditorState.createEmpty()})),i=Object(a.a)(r,2),l=i[0],o=i[1];function u(){return(u=Object(x.a)(O.a.mark((function e(n){var r,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),r=(r=Object(Me.convertToRaw)(l.getCurrentContent())).blocks.map((function(e){return e.text.trim()?e.text:"\n"})).join("").replace(/\s/g,""),e.prev=3,e.next=6,_e(t.publicKey.get(),r);case 6:a=e.sent,e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(3),e.abrupt("return",N("Invalid encrypted message"));case 12:return e.next=14,Oe(a,r,t);case 14:c.merge({modalIsOpened:!1}),o(Me.EditorState.createEmpty()),je("Message decrypted!");case 17:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("button",{className:"pure-button pure-button-primary bg-black w-full",onClick:function(e){e.preventDefault(),c.merge({modalIsOpened:!0})},children:"Decrypt message"}),Object(V.jsx)(H,{isOpened:c.modalIsOpened.get(),close:function(){c.merge({modalIsOpened:!1})},children:Object(V.jsxs)("form",{onSubmit:function(e){return u.apply(this,arguments)},children:[Object(V.jsx)("div",{className:"border-gray-300 border border-solid p-2",children:Object(V.jsx)(Me.Editor,{editorState:l,onChange:o,placeholder:"Paste the encrypted message",ref:n})}),Object(V.jsx)("div",{className:"flex justify-end my-2",children:Object(V.jsx)("button",{type:"submit",className:"pure-button pure-button-primary pure-button-primary bg-black",disabled:!l.getCurrentContent().hasText(),children:"Decrypt message"})})]})})]})}function Ye(e,t){return qe.apply(this,arguments)}function qe(){return(qe=Object(x.a)(O.a.mark((function e(t,n){var c,r,s,i,l,o,u,d;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=n.name.match(/-(.*)\.txt$/),!Object(m.isEmpty)(c)){e.next=3;break}throw new Error("Invalid encrypted file");case 3:return r=Object(a.a)(c,2),s=r[0],i=r[1],l=Ue(n.name.replace(s,"")),o=Object(Ae.decodeBase64)(t),e.t0=p.box,e.t1=Uint8Array,e.next=10,n.arrayBuffer();case 10:return e.t2=e.sent,e.t3=new e.t1(e.t2),e.t4=l,e.t5=o,e.next=16,Ve();case 16:return e.t6=e.sent,u=e.t0.open.call(e.t0,e.t3,e.t4,e.t5,e.t6),d=new Blob([u],{type:"application/octet-stream"}),e.abrupt("return",{decryptedFile:d,fileName:"".concat(Object(pe.a)(),".").concat(i)});case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ge(e){var t=e.contact,n=Object(s.useRef)(),c=Object(d.c)({fileProcessing:!1,modalIsOpened:!1});function r(){return(r=Object(x.a)(O.a.mark((function e(n){var r,a,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),c.merge({fileProcessing:!0}),e.prev=2,e.next=5,Ye(t.publicKey.get(),n.target.files[0]);case 5:r=e.sent,a=r.decryptedFile,s=r.fileName,le(a,s),e.next=16;break;case 11:return e.prev=11,e.t0=e.catch(2),n.target.value="",c.merge({fileProcessing:!1}),e.abrupt("return",N("Unable to decrypt file"));case 16:n.target.value="",c.merge({fileProcessing:!1,modalIsOpened:!1}),je("File ready");case 19:case"end":return e.stop()}}),e,null,[[2,11]])})))).apply(this,arguments)}return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("button",{className:"pure-button pure-button-primary bg-black w-full",onClick:function(e){e.preventDefault(),c.merge({modalIsOpened:!0})},children:"Decrypt file"}),Object(V.jsxs)(H,{isOpened:c.modalIsOpened.get(),close:function(){c.fileProcessing.get()||c.merge({modalIsOpened:!1})},children:[Object(V.jsx)("input",{type:"file",className:"hidden",ref:n,onChange:function(e){return r.apply(this,arguments)}}),Object(V.jsx)("div",{className:"my-1",children:"As soon as the file is decrypted, you can download it"}),Object(V.jsx)("button",{className:"pure-button pure-button-primary bg-black w-full",onClick:function(e){e.preventDefault(),n.current.click()},disabled:c.fileProcessing.get(),children:"Select encrypted file"})]})]})}function Qe(e,t){return Xe.apply(this,arguments)}function Xe(){return(Xe=Object(x.a)(O.a.mark((function e(t,n){var c,r,a,s,i;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=Object(p.randomBytes)(p.box.nonceLength),r=Object(Ae.decodeBase64)(t),e.t0=p.box,e.t1=Uint8Array,e.next=6,n.arrayBuffer();case 6:return e.t2=e.sent,e.t3=new e.t1(e.t2),e.t4=c,e.t5=r,e.next=12,Ve();case 12:return e.t6=e.sent,a=(0,e.t0)(e.t3,e.t4,e.t5,e.t6),s=new Blob([a],{type:"application/octet-stream"}),i=n.name.split(".").pop(),e.abrupt("return",{fileName:"".concat(Re(c),"-").concat(i,".txt"),outputFile:s});case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ze(e){var t=e.contact,n=Object(s.useRef)(),c=Object(d.c)({fileProcessing:!1,modalIsOpened:!1});function r(){return(r=Object(x.a)(O.a.mark((function e(n){var r,a,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),c.merge({fileProcessing:!0}),e.next=4,Qe(t.publicKey.get(),n.target.files[0]);case 4:r=e.sent,a=r.outputFile,s=r.fileName,n.target.value="",le(a,s),c.merge({fileProcessing:!1,modalIsOpened:!1}),je("File encrypted");case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("button",{className:"pure-button pure-button-primary bg-black w-full",onClick:function(e){e.preventDefault(),c.merge({modalIsOpened:!0})},children:"Encrypt file"}),Object(V.jsxs)(H,{isOpened:c.modalIsOpened.get(),close:function(){c.fileProcessing.get()||c.merge({modalIsOpened:!1})},children:[Object(V.jsx)("input",{type:"file",className:"hidden",ref:n,onChange:function(e){return r.apply(this,arguments)}}),Object(V.jsxs)("div",{className:"my-1",children:["As soon as the file is encrypted you will download it, ",Object(V.jsx)("span",{className:"font-bold",children:"do not rename it"})]}),Object(V.jsx)("button",{className:"pure-button pure-button-primary bg-black w-full",onClick:function(e){e.preventDefault(),n.current.click()},disabled:c.fileProcessing.get(),children:"Select unencrypted file"})]})]})}function $e(){for(var e=[],t=arguments.length,n=new Array(t),c=0;c<t;c++)n[c]=arguments[c];return n.forEach((function(t){t&&t.split(/\s/g).forEach((function(t){t.length>0&&e.push(t)}))})),e.join(" ")}var et=n(125);function tt(e){var t,n,c=e.message,r=e.contact,a=c.messageRaw,s=c.createdAt,i=c.mine,l=c.encryptedMessage;return i.get()?(t="justify-end pl-20",n="text-right"):(t="pr-20",n="bg-green-300"),Object(V.jsx)("div",{className:$e("flex",t),children:Object(V.jsxs)("div",{className:$e("whitespace-pre-wrap my-1 p-2 border border-solid border-gray-300 rounded break-all",n),children:[a.get(),Object(V.jsx)("div",{className:$e("pt-1"),children:Object(V.jsx)(et.a,{datetime:s.get()})}),Object(V.jsxs)("div",{className:"text-xs border-solid border-gray-300 border-t p-1",children:["#",l.get().substring(0,8),Object(V.jsx)("button",{className:"ml-1 text-red-500",onClick:function(e){e.preventDefault(),c.get().destroy(r),je("Message removed")},children:"(x)"})]})]})})}var nt,ct=n(60),rt=n.n(ct);function at(e){var t=e.contact,n=Object(s.useRef)(null);return Object(s.useEffect)((function(){t.messages.length>0||t.get().loadPrivateMessages(t)}),[t.id.get()]),Object(V.jsxs)("div",{children:[Object(V.jsx)("div",{className:"text-lg italic",children:"Private messages"}),Object(V.jsxs)("div",{className:"py-2 flex justify-between",children:[Object(V.jsxs)("div",{className:"w-1/2 pr-1",children:[Object(V.jsx)(Je,{contact:t}),Object(V.jsx)("div",{className:"pt-1",children:Object(V.jsx)(Ge,{contact:t})})]}),Object(V.jsxs)("div",{className:"w-1/2 pl-1",children:[Object(V.jsx)(We,{contact:t}),Object(V.jsx)("div",{className:"pt-1",children:Object(V.jsx)(Ze,{contact:t})})]})]}),Object(V.jsx)("div",{className:"scroll-container",ref:n,children:Object(V.jsx)(rt.a,{viewportRef:n,items:t.messages,itemMinSize:20,children:function(e){return Object(V.jsx)("div",{className:"item",children:Object(V.jsx)(tt,{message:e,contact:t})},e.id.get())}})})]})}function st(){return Object(V.jsx)("div",{children:"public"})}function it(){var e,t,n=Object(l.h)().id,c=Object(l.i)(),r=c.path,a=c.url,i=Object(d.c)({contact:null,ready:!1});Object(s.useEffect)((function(){(function(e){return Ce.apply(this,arguments)})(n).then((function(e){i.merge({contact:e,ready:!0})}))}),[n]);var o=i.contact,u=i.ready;return(null===o||void 0===o||null===(e=o.id)||void 0===e?void 0:e.get())||u.get()?(null===o||void 0===o||null===(t=o.id)||void 0===t?void 0:t.get())?Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(ne.a,{children:Object(V.jsx)("title",{children:re(o.name.get())})}),Object(V.jsx)("div",{className:"w-full md:w-1/3 mx-auto",children:Object(V.jsxs)("div",{children:[Object(V.jsx)("div",{className:"flex justify-center pb-2",children:Object(V.jsx)(Se,{contact:o,height:"h-20",width:"w-20"})}),Object(V.jsxs)("div",{className:"flex flex-wrap justify-center items-center",children:[Object(V.jsx)("h1",{className:"text-right pr-1",children:o.name.get()}),Object(V.jsx)("div",{className:"pl-1",children:Object(V.jsx)(De,{contact:o})})]}),Object(V.jsxs)("div",{children:[Object(V.jsxs)("div",{className:"my-1 flex justify-center",children:[Object(V.jsx)("div",{className:"px-1 underline",children:Object(V.jsx)(X.b,{to:"".concat(a),children:"Private Messages"})}),Object(V.jsx)("div",{className:"px-1 underline",children:Object(V.jsx)(X.b,{to:"".concat(a,"/public-messages"),children:"Public Messages"})})]}),Object(V.jsxs)(l.c,{children:[Object(V.jsx)(l.a,{exact:!0,path:r,children:Object(V.jsx)(at,{contact:o})}),Object(V.jsx)(l.a,{path:"".concat(r,"/public-messages"),children:Object(V.jsx)(st,{})})]})]})]})})]}):Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(ne.a,{children:Object(V.jsx)("title",{children:re("Contact not found")})}),Object(V.jsx)("div",{children:"Contact not found"})]}):null}function lt(){var e=Object(d.c)({inputPkNameEmail:"",modalOpened:!1});return Object(V.jsxs)("div",{children:[Object(V.jsx)("button",{className:"bg-black text-white p-3",onClick:function(t){t.preventDefault(),e.merge({modalOpened:!0})},children:"+ Add new contact"}),Object(V.jsx)(H,{isOpened:e.modalOpened.get(),close:function(){e.merge({modalOpened:!1})},children:Object(V.jsx)("form",{className:"pure-form pure-form-aligned",onSubmit:function(t){t.preventDefault(),function(e){var t=e.replace(/\s/g,"").split("."),n=Object(a.a)(t,3),c=n[0],r=n[1],s=n[2];r=atob(r),r=Object(m.isEmpty)(r)?"Unknown user":r,new we({emailHash:s,id:Object(pe.a)(),name:r,publicKey:ze(c)}).save()}(e.inputPkNameEmail.get()),e.merge({inputPkNameEmail:"",modalOpened:!1})},children:Object(V.jsxs)("fieldset",{children:[Object(V.jsx)("legend",{children:"Contact public key, name and email hashed"}),Object(V.jsx)("div",{className:"pure-control-group",children:Object(V.jsx)("input",{name:"inputPkNameEmail",value:e.inputPkNameEmail.get(),onChange:function(t){var n=t.target.value;e.merge({inputPkNameEmail:n})},placeholder:"Paste the contact code",autoComplete:"nope",className:"w-full"})}),Object(V.jsx)("button",{type:"submit",className:"pure-button pure-button-primary bg-black w-full",disabled:Object(m.isEmpty)(e.inputPkNameEmail.get()),children:"Add"})]})})})]})}function ot(e){var t=e.contact;return Object(V.jsxs)("div",{className:"flex flex-wrap items-center justify-between p-2 bg-gray-300 my-2 rounded",children:[Object(V.jsx)("div",{children:Object(V.jsx)(X.b,{to:"/contacts/".concat(t.id.get()),children:Object(V.jsxs)("div",{className:"flex items-center",children:[Object(V.jsx)(Se,{contact:t,height:"h-20",width:"w-20"}),Object(V.jsx)("span",{className:"pl-2",children:t.name.get()})]})})}),Object(V.jsx)("div",{children:Object(V.jsx)("button",{onClick:function(e){e.preventDefault(),t.get().destroy()},children:"Remove"})})]})}function ut(){var e=Object(d.c)(Ne),t=Object(s.useRef)(null);return Object(V.jsx)("div",{className:"scroll-container",ref:t,children:Object(V.jsx)(rt.a,{viewportRef:t,items:e.contacts,itemMinSize:20,children:function(e){return Object(V.jsx)("div",{className:"item",children:Object(V.jsx)(ot,{contact:e})},e.id.get())}})})}function dt(e){var t=e.children,n=Object(s.useState)(),c=Object(a.a)(n,2),r=c[0],i=c[1];return Object(s.useEffect)((function(){Ee().then((function(e){i(e)}))}),[i]),r?t:null}function jt(){var e=b("gravatar-enabled"),t=Object(a.a)(e,2),n=t[0],c=t[1],r=Object(d.c)({modalIsOpened:!1});if("NOT_READY"===n)return null;return Object(V.jsxs)("div",{children:[Object(V.jsxs)("div",{className:"flex items-center",children:[Object(V.jsx)("input",{type:"checkbox",checked:!!n,onChange:function(){c(!n)}}),Object(V.jsx)("span",{className:"ml-1",children:"Toggle gravatar"})]}),Object(V.jsx)("div",{className:"mt-1",children:Object(V.jsx)("button",{className:"underline",onClick:function(e){e.preventDefault(),r.merge({modalIsOpened:!0})},children:"Is gravatar safe?"})}),Object(V.jsx)(H,{isOpened:r.modalIsOpened.get(),close:function(){r.merge({modalIsOpened:!1})},children:Object(V.jsxs)("div",{children:[Object(V.jsx)("h1",{className:"text-xl font-bold",children:"Is gravatar safe?"}),Object(V.jsxs)("div",{children:["The short answer if you need 100% security is ",Object(V.jsx)("b",{children:"NO"}),"."]}),Object(V.jsxs)("div",{children:["Otherwise ",Object(V.jsx)("b",{children:"maybe"}),", because you get tracked by gravatar, but they store images for free. Depends on you if are going to accept that risk."]})]})})]})}function bt(){return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(ne.a,{children:Object(V.jsx)("title",{children:re("Contacts")})}),Object(V.jsxs)("div",{className:"w-full md:w-1/3 mx-auto pt-4",children:[Object(V.jsx)("h1",{className:"text-center text-2xl font-bold",children:"Contacts"}),Object(V.jsxs)("div",{className:"flex justify-between",children:[Object(V.jsx)(jt,{}),Object(V.jsx)(lt,{})]}),Object(V.jsx)("div",{children:Object(V.jsx)(dt,{children:Object(V.jsx)(ut,{})})})]})]})}function pt(e){return Object(y.MD5)(e).toString()}function mt(){var e=oe("name"),t=Object(a.a)(e,2),n=t[0],c=t[1],r=oe("email"),s=Object(a.a)(r,2),i=s[0],l=s[1],o=Object(d.c)({modalIsOpened:!1});function u(){o.merge({modalIsOpened:!1})}return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("button",{className:"underline",onClick:function(e){e.preventDefault(),o.merge({modalIsOpened:!0})},children:"Edit profile"}),Object(V.jsx)(H,{isOpened:o.modalIsOpened.get(),close:u,children:Object(V.jsxs)("form",{className:"pure-form pure-form-aligned",onSubmit:function(e){e.preventDefault(),u(),je("Profile saved")},children:[Object(V.jsxs)("fieldset",{children:[Object(V.jsx)("legend",{children:"Edit profile"}),Object(V.jsx)("div",{className:"flex justify-center",children:Object(V.jsx)(Se,{emailHash:pt(i),height:"h-20",width:"w-20"})})]}),Object(V.jsx)("div",{className:"pure-control-group",children:Object(V.jsx)("input",{name:"name",value:n,onChange:function(e){c(e.target.value)},placeholder:"Name",className:"w-full"})}),Object(V.jsxs)("div",{className:"pure-control-group",children:[Object(V.jsx)("input",{name:"email",value:i,onChange:function(e){l(e.target.value)},placeholder:"Email(optional)",className:"w-full"}),Object(V.jsxs)("span",{className:"pure-form-message",children:["Only the email MD5 hash is shared, not your real email. A image can be set for this email on ",Object(V.jsx)("a",{className:"underline",href:"https://gravatar.com/",target:"_blank",children:"gravatar.com"})]})]}),Object(V.jsx)("button",{type:"submit",className:"pure-button pure-button-primary w-full bg-black",children:"Save"})]})})]})}function ht(){var e,t=C().publicKey,n=Re(t),c=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var c=Object(s.useState)({}),r=Object(a.a)(c,2),i=r[0],l=r[1];return Object(s.useEffect)((function(){var e=t.map(function(){var e=Object(x.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,P(t);case 3:return e.t1=e.sent,e.abrupt("return",{keyName:e.t0,value:e.t1});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());Promise.all(e).then((function(e){var t={};e.forEach((function(e){t[e.keyName]=e.value})),l(t)}))}),[l,t]),i}("name","email"),r=c.name,i=c.email,l=r?Re((e=r,(new TextEncoder).encode(e))):"",o=i?pt(i):"",u="".concat(n,".").concat(l,".").concat(o),j=Object(d.c)({showCopied:!1});if(Object(s.useEffect)((function(){return function(){nt&&clearTimeout(nt)}}),[]),!n)return null;if(void 0===r||void 0===i)return null;return Object(V.jsx)("div",{className:"p-3",children:Object(V.jsxs)("button",{className:"text-center bg-gray-300 hover:bg-gray-200 rounded p-2 border border-solid border-gray-300",onClick:function(e){e.preventDefault(),de(be(u)),j.merge({showCopied:!0}),nt=setTimeout((function(){j.merge({showCopied:!1})}),1500)},children:[Object(V.jsx)("div",{className:"font-bold",children:"My public key, name and email hashed"}),Object(V.jsx)("div",{className:"break-all",children:j.showCopied.get()?"Copied":u}),Object(V.jsx)("div",{className:"text-right text-sm",children:"Click to copy"})]})})}function ft(){return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(ne.a,{children:Object(V.jsx)("title",{children:re("Home")})}),Object(V.jsxs)("div",{className:"mx-auto md:w-1/3 w-full my-2 flex justify-between",children:[Object(V.jsx)(X.b,{to:"/about",children:Object(V.jsx)("span",{className:"underline",children:"About"})}),Object(V.jsx)(mt,{}),Object(V.jsx)(X.b,{to:"/backup",children:Object(V.jsx)("span",{className:"underline",children:"Backup service"})})]}),Object(V.jsx)("div",{className:"flex justify-center",children:Object(V.jsx)(ht,{})})]})}function Ot(){return Object(V.jsx)("div",{className:"text-center text-3xl font-bold",children:"Page not found"})}function xt(e){var t=e.children;return Object(V.jsx)(X.a,{children:t})}function gt(e){return new Promise((function(t){var n=new FileReader;n.onload=function(){var e=Object(x.a)(O.a.mark((function e(n){var c,r,a,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=JSON.parse(n.target.result),e.next=3,u.clear();case 3:for(a in r=[],c)s=c[a],r.push(u.setItem(a,s));return e.next=7,Promise.all(r);case 7:t();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.readAsText(e)}))}function vt(){var e=Object(d.c)({backupValue:"",modalOpened:!1,pinValue:"",showError:!1}),t=Object(s.useState)(),n=Object(a.a)(t,2),c=n[0],r=n[1],i=Object(l.f)(),o=new URLSearchParams(Object(l.g)().search),u=C().setKeyPair;function j(){return(j=Object(x.a)(O.a.mark((function t(n){var r,a;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),r=o.get("redirectTo")||"/",K(e.pinValue.get()),t.prev=3,Object(m.isEmpty)(e.backupValue)){t.next=7;break}return t.next=7,gt(c);case 7:return t.next=9,P("key-pair");case 9:if(a=t.sent,!Object(m.isEmpty)(a)){t.next=12;break}return t.abrupt("return",e.merge({backupFile:null,backupValue:"",modalOpened:!1,pinValue:"",showError:!0}));case 12:u(a),i.push(r),t.next=19;break;case 16:return t.prev=16,t.t0=t.catch(3),t.abrupt("return",e.merge({backupFile:null,backupValue:"",modalOpened:!1,pinValue:"",showError:!0}));case 19:case"end":return t.stop()}}),t,null,[[3,16]])})))).apply(this,arguments)}return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(ne.a,{children:Object(V.jsx)("title",{children:re("Unlock")})}),Object(V.jsxs)("div",{className:"w-full md:w-1/3 mx-auto",children:[Object(V.jsx)("div",{className:"flex justify-center",children:Object(V.jsx)("img",{src:L,alt:"enigma"})}),Object(V.jsx)("form",{className:"pure-form",onSubmit:function(e){return j.apply(this,arguments)},children:Object(V.jsxs)("fieldset",{children:[Object(V.jsxs)("div",{className:"pure-control-group py-2",children:[Object(V.jsx)("input",{type:"password",value:e.pinValue.get(),onChange:function(t){var n=t.target.value;e.merge({pinValue:n})},className:"w-full",placeholder:"Enter your PIN to continue"}),e.showError.get()&&Object(V.jsx)("span",{className:"pure-form-message text-red-500",children:"Invalid PIN"})]}),Object(V.jsx)("button",{type:"submit",className:"pure-button pure-button-primary w-full bg-black font-bold",disabled:Object(m.isEmpty)(e.pinValue.get()),children:"Unlock"}),Object(V.jsxs)("div",{className:"pure-control-group pt-4",children:[Object(V.jsx)("div",{className:"flex justify-end",children:Object(V.jsx)("button",{onClick:function(t){t.preventDefault(),e.merge({modalOpened:!0})},className:"underline",children:"Restore from backup"})}),Object(V.jsxs)(H,{isOpened:e.modalOpened.get(),close:function(){e.merge({modalOpened:!1})},children:[Object(V.jsx)("h1",{className:"font-lg font-bold",children:"Restore from backup"}),Object(V.jsx)("p",{children:"Select a backup file:"}),Object(V.jsx)("input",{type:"file",accept:".json",value:e.backupValue.get(),onChange:function(t){var n=t.target.value;e.merge({backupValue:n}),r(t.target.files[0])}}),Object(V.jsxs)("div",{className:"pt-2",children:[Object(V.jsx)("span",{className:"font-bold",children:"Warning"}),", restoring data from a backup, ",Object(V.jsx)("em",{children:"will override the current data"}),Object(V.jsxs)("div",{children:["Make sure, that you have a ",Object(V.jsx)("b",{children:"backup of the current data"}),"."]}),Object(V.jsx)("div",{children:"If you have a backup, then it's safe."})]})]})]})]})})]})]})}function yt(){return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(ae,{children:Object(V.jsx)(xt,{children:Object(V.jsx)(ie,{children:Object(V.jsxs)(l.c,{children:[Object(V.jsx)(te,{path:"/",exact:!0,children:Object(V.jsx)(ft,{})}),Object(V.jsx)(te,{path:"/about",children:Object(V.jsx)(se,{})}),Object(V.jsx)(te,{path:"/backup",children:Object(V.jsx)(ue,{})}),Object(V.jsx)(te,{path:"/contacts/:id",children:Object(V.jsx)(it,{})}),Object(V.jsx)(te,{path:"/contacts",children:Object(V.jsx)(bt,{})}),Object(V.jsx)(l.a,{path:"/unlock",children:Object(V.jsx)(Y,{children:Object(V.jsx)(vt,{})})}),Object(V.jsx)(l.a,{path:"*",children:Object(V.jsx)(Ot,{})})]})})})}),Object(V.jsx)(w.a,{})]})}var wt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,271)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),c(e),r(e),a(e),s(e)}))};z.a.render(Object(V.jsx)(i.a.StrictMode,{children:Object(V.jsx)(yt,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/enigma-reloaded",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/enigma-reloaded","/service-worker.js");c?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var c=n.headers.get("content-type");404===n.status||null!=c&&-1===c.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):r(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):r(t,e)}))}}(),wt()}},[[267,1,2]]]);
//# sourceMappingURL=main.eca1cd23.chunk.js.map