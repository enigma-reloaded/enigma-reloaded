{"version":3,"sources":["serviceWorkerRegistration.js","lib/hooks/use-local-forage.js","lib/feedback/error.js","lib/utils/encryption/encrypted-storage.js","lib/utils/encryption/storage.js","lib/hooks/use-key-pairs.js","components/pages/home/home-description/faq-question.jsx","assets/example.mp4","components/pages/home/home-description/about.jsx","assets/enigma-logo.jpg","components/pages/home/home-page-description.jsx","components/utils/modal.jsx","components/setup/generate-private-key.jsx","lib/utils/encryption/generate-keys.js","components/page/app-setup.jsx","components/page/navigation.jsx","components/page/unlocked.jsx","lib/hooks/use-require-unlock.js","components/page/page-title.jsx","components/pages/about.jsx","components/page/layout.jsx","lib/utils/files/download-file.js","lib/hooks/use-encrypted-storage.js","components/pages/backup.jsx","lib/utils/actions/copy-to-clipboard.js","lib/feedback/success.js","lib/utils/undetectable/split-string.js","lib/utils/numbers/random-number.js","lib/private-messages/private-message-record.js","lib/private-messages/private-messages-store.js","lib/contacts/record-contact.js","lib/contacts/contacts-store.js","assets/user-placeholder.svg","components/contacts/avatar.jsx","components/pages/contact/edit-contact.jsx","lib/utils/encryption/keys.js","lib/utils/undetectable/format-to-base-64-undetectable.js","lib/utils/encryption/encrypt-message.js","components/pages/contact/create-new-private-message.jsx","lib/utils/undetectable/decode-base-64-undetectable.js","lib/utils/encryption/decrypt-message.js","components/pages/contact/decode-new-private-message.jsx","lib/utils/encryption/decrypt-file.js","components/pages/contact/decrypt-file.jsx","lib/utils/encryption/encrypt-file.js","components/pages/contact/encrypt-file.jsx","lib/utils/string/merge-styles.js","components/pages/contact/message.jsx","components/pages/home/show-sharable-public-key.jsx","components/pages/contact/private-messages.jsx","components/pages/contact/public-messages.jsx","components/pages/contact.jsx","components/pages/contacts/add-new-contact.jsx","lib/contacts/import-contact-from-string.js","components/pages/contacts/contact-list-item.jsx","components/pages/contacts/ contacts-list.jsx","components/pages/contacts/contacts-store-loader.jsx","components/pages/contacts/toggle-enable-gravatar.jsx","components/pages/contacts.jsx","lib/utils/format/md5.js","components/pages/home/edit-profile.jsx","lib/utils/format/string-to-u8.js","lib/utils/format/keys.js","components/pages/home.jsx","components/pages/page-not-found.jsx","components/config/router.jsx","lib/backup/restore-from-json-file.js","components/pages/unlock.jsx","lib/hooks/use-query-params.js","app.jsx","reportWebVitals.js","index.js"],"names":["isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","state","controller","console","log","onUpdate","onSuccess","catch","error","globalState","createState","useLocalForage","keyName","useState","useEffect","undefined","get","localforage","value","merge","outputValue","feedbackError","message","toast","encryptStorage","EncryptStorage","secret","storage","this","key","data","JSON","stringify","toString","Error","result","encryptedData","Crypto","encrypt","setItem","e","a","getItem","decryptedData","decrypt","Utf8","parse","removeItem","store","privateKey","publicKey","useKeyPairs","setKeyPair","getItemFromStorage","deleteItemInStorage","setItemInStorage","setStoragePin","pin","exportStorage","iterate","disableStorage","FaqQuestion","title","children","className","EnigmaAbout","href","target","controls","src","demo","type","HomePageDescription","button","logo","alt","Modal","isOpened","close","el","useMemo","document","getElementById","body","classList","add","remove","modalContentRef","useRef","useOnClickOutside","output","ref","createPortal","SetupGeneratePrivateKey","setIsPrivateKeyInitialized","confirmMatch","confirmPinValue","emailValue","nameValue","passwordStrength","pinValue","setupPinModal","submitDisabled","isEmpty","onClick","preventDefault","onSubmit","keyPair","box","Array","from","secretKey","toLowerCase","replace","name","onChange","placeholder","strength","s","autoComplete","required","length","disabled","AppSetup","useLocation","history","useHistory","isPrivateKeyInitialized","initialized","notReady","pathname","push","PageNavigation","NavigationItem","text","to","setTimeout","Unlocked","isUnlocked","setState","isIdle","useIdle","useRequireUnlock","UnlockedRoute","opts","pageTitle","buildPageTitle","input","PageTitle","AboutPage","AppLayout","downloadFile","blob","fileName","url","URL","createObjectURL","createElement","download","appendChild","click","revokeObjectURL","useEncryptedStorage","BackupPage","buttonDisabled","Blob","copyToClipboard","setAttribute","select","execCommand","removeChild","feedBackSuccess","success","undetectableSplitString","str","nextWordSize","min","max","strLng","i","Math","floor","random","PrivateMessageRecord","id","messageRaw","encryptedMessage","contact","createdAt","mine","messages","set","m","splice","rawMessages","serialize","substring","contactIndex","findIndex","filter","none","createNewPrivateMessageRecord","Date","toISOString","uuidv4","record","save","insertDecryptedMessageRecord","loadPrivateMessagesForContact","map","loadedFromStorage","RecordContact","emailHash","contactRecord","contacts","existingContact","find","c","Object","assign","serializeWithoutId","contactsStore","removeContact","hookstate","getContactsStore","sortedContacts","sortBy","contactStore","ContactAvatar","height","width","gravatarEnabled","displayedEmailHash","userPlaceholder","EditContact","modalIsOpened","closeModal","formatToBase64Undetectable","string","encodeBase64","getPrivateKey","pk","Uint8Array","encryptMessage","publicKeyString","messageString","pubKeyUInt8Array","decodeBase64","msgUInt8Array","decodeUTF8","nonce","randomBytes","nonceLength","formatNonce","sample","CreateNewPrivateMessage","editorRef","current","focus","reactUseState","EditorState","createEmpty","editorState","setEditorState","rawContent","convertToRaw","getCurrentContent","blocks","block","trim","join","copyToClipBoard","hasText","decodeBase64Undetectable","base64String","restoreBase64String","base64StringUndetectable","slice","decryptMessage","encryptedString","split","encryptedMessageString","nonceString","decryptedMessage","open","encodeUTF8","DecodeNewPrivateMessage","encryptedContentRaw","decryptFile","encryptedFile","fullExtension","extension","arrayBuffer","decryptedFileInt8","decryptedFile","DecryptFile","inputRef","fileProcessing","files","encryptFile","file","outputFileIntArray","outputFile","pop","EncryptFile","mergeStyles","forEach","blockOfClasses","Message","ownerClassContainer","ownerClass","datetime","destroy","copyTimeout","PrivateMessages","loadPrivateMessages","viewportRef","items","itemMinSize","PublicMessages","ContactPage","useParams","useRouteMatch","path","ready","getContact","exact","AddNewContact","inputPkNameEmail","modalOpened","atob","importContactFromString","ContactListItem","ContactsList","ContactsStoreLoader","setContactsStore","ToggleEnableGravatar","setGravatar","checked","ContactsPage","md5","cryptoMd5","EditProfile","setName","email","setEmail","ShowSharablePublicKey","readableKey","keyNames","promises","Promise","all","values","v","useMultipleEncryptedStorage","encodedName","TextEncoder","encode","encodedEmail","showCopied","clearTimeout","HomePage","PageNotFound","Router","restoreBackupFromJsonFile","resolve","fileReader","FileReader","onload","json","k","readAsText","UnlockPage","backupValue","showError","useReactState","fileState","setFileState","queryParams","URLSearchParams","search","redirectTo","backupFile","accept","App","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","process","origin","addEventListener","fetch","headers","response","contentType","status","indexOf","unregister","reload","checkValidServiceWorker","serviceWorkerRegistration"],"mappings":"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","file":"static/js/main.d071d5b9.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n    window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/),\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n              'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://cra.link/PWA',\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n      .register(swUrl)\n      .then((registration) => {\n        registration.onupdatefound = () => {\n          const installingWorker = registration.installing;\n          if (installingWorker == null) {\n            return;\n          }\n          installingWorker.onstatechange = () => {\n            if (installingWorker.state === 'installed') {\n              if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n                console.log(\n                    'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://cra.link/PWA.',\n                );\n\n                // Execute callback\n                if (config && config.onUpdate) {\n                  config.onUpdate(registration);\n                }\n              } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n                console.log('Content is cached for offline use.');\n\n                // Execute callback\n                if (config && config.onSuccess) {\n                  config.onSuccess(registration);\n                }\n              }\n            }\n          };\n        };\n      })\n      .catch((error) => {\n        console.error('Error during service worker registration:', error);\n      });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: {'Service-Worker': 'script'},\n  })\n      .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n        const contentType = response.headers.get('content-type');\n        if (\n          response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n        ) {\n        // No service worker found. Probably a different app. Reload the page.\n          navigator.serviceWorker.ready.then((registration) => {\n            registration.unregister().then(() => {\n              window.location.reload();\n            });\n          });\n        } else {\n        // Service worker found. Proceed as normal.\n          registerValidSW(swUrl, config);\n        }\n      })\n      .catch(() => {\n        console.log('No internet connection found. App is running in offline mode.');\n      });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n        .then((registration) => {\n          registration.unregister();\n        })\n        .catch((error) => {\n          console.error(error.message);\n        });\n  }\n}\n","import * as localforage from 'localforage';\nimport {createState, useState} from '@hookstate/core';\nimport {useEffect} from 'react';\nconst globalState = createState({});\n\nexport function useLocalForage(keyName) {\n  const state = useState(globalState);\n\n  useEffect(() => {\n    if (state[keyName].get() !== undefined) return;\n\n    localforage.getItem(keyName).then((value) => {\n      state.merge({\n        [keyName]: value,\n      });\n    });\n  }, [keyName, state]);\n\n  function setter(value) {\n    state.merge({\n      [keyName]: value,\n    });\n    localforage.setItem(keyName, value);\n  }\n  let outputValue = state[keyName].get();\n  if (outputValue === undefined) {\n    outputValue = 'NOT_READY';\n  }\n\n  return [outputValue, setter];\n}","import {toast} from 'react-toastify';\n\nexport function feedbackError(message) {\n  toast.error(message);\n}","import * as Crypto from 'crypto-js';\nimport {feedbackError} from '../../feedback/error';\n\nexport class EncryptStorage {\n  constructor(secret, storage) {\n    this.secret = secret;\n    this.storage = storage;\n  }\n\n  encrypt(key, data) {\n    if (typeof data === 'object') {\n      data = JSON.stringify(data);\n    } else if (typeof data === 'number') {\n      data = data.toString();\n    } else if (typeof data !== 'string') {\n      throw new Error('invalid type');\n    }\n    const encryptedData = Crypto.AES.encrypt(data, this.secret);\n    let result;\n\n    try {\n      result = this.storage.setItem(key, encryptedData.toString());\n    } catch (e) {\n      feedbackError('Unable to save more data');\n      throw e;\n    }\n\n    return result;\n  }\n\n  async decrypt(key) {\n    const data = await this.storage.getItem(key);\n    let decryptedData = null;\n    if (data) {\n      decryptedData = (Crypto.AES.decrypt(data, this.secret)).toString(Crypto.enc.Utf8);\n      try {\n        decryptedData = JSON.parse(decryptedData);\n      } catch (e) {}\n    }\n    return decryptedData;\n  }\n\n  remove(key) {\n    return this.storage.removeItem(key);\n  }\n}","import * as localforage from 'localforage';\nimport {EncryptStorage} from './encrypted-storage';\nimport {resetKeyPairs} from '../../hooks/use-key-pairs';\nlet encryptStorage;\nwindow.localforage = localforage;\n\nexport function getItemFromStorage(keyName) {\n  if (!encryptStorage) return null;\n  return encryptStorage.decrypt(keyName);\n}\n\nexport function deleteItemInStorage(keyName) {\n  if (!encryptStorage) throw new Error('Pin not set');\n\n  return encryptStorage.storage.removeItem(keyName);\n}\n\nexport function setItemInStorage(keyName, value) {\n  if (!encryptStorage) throw new Error('Pin not set');\n  return encryptStorage.encrypt(keyName, value);\n}\n\nexport function setStoragePin(pin) {\n  encryptStorage = new EncryptStorage(pin, localforage);\n}\n\nexport async function exportStorage() {\n  const result = {};\n  await encryptStorage.storage.iterate((value, key) => {\n    result[key] = value;\n  });\n\n  return result;\n}\n\nexport function disableStorage() {\n  encryptStorage = null;\n  resetKeyPairs();\n}","import {createState, useState} from '@hookstate/core';\n\nconst store = createState({\n  privateKey: null,\n  publicKey: null,\n});\n\nexport function useKeyPairs() {\n  const state = useState(store);\n\n  return {\n    privateKey: state.privateKey.get(),\n    publicKey: state.publicKey.get(),\n    setKeyPair({publicKey, privateKey}) {\n      store.merge({\n        privateKey, publicKey,\n      });\n    },\n  };\n}\n\nexport function resetKeyPairs() {\n  store.merge({\n    privateKey: null,\n    publicKey: null,\n  });\n}","export default function FaqQuestion({title, children}) {\n  return (\n    <div className=\"p-2 bg-gray-300 rounded my-2\">\n      <div className=\"italic font-bold\">{title}</div>\n      <div className=\"pt-2\">\n        {children}\n      </div>\n    </div>\n  );\n}","export default __webpack_public_path__ + \"static/media/example.87b40669.mp4\";","import FaqQuestion from './faq-question';\nimport demo from '../../../../assets/example.mp4';\n\nexport default function EnigmaAbout() {\n  return (\n    <>\n      <div className=\"w-full md:w-1/2\">\n        <div className=\"font-bold text-3xl\">\n          Engima Reloaded\n        </div>\n\n        <div className=\"mt-12\">\n          <div className=\"font-bold mb-2\">\n            Features\n          </div>\n\n          <div className=\"pl-4\">\n            <ul className=\"list-disc\">\n              <li>\n                DIY Encrypt and decrypt messages and files\n              </li>\n              <li>\n                <a href=\"https://github.com/enigma-reloaded/enigma-reloaded/blob/master/LICENSE\" target=\"_blank\" className=\"underline\">\n                  Open source license(GPL V3)\n                </a> and <a href=\"https://github.com/enigma-reloaded/enigma-reloaded\" target=\"_blank\" className=\"underline\">open source code</a>\n              </li>\n              <li className=\"mt-2\">\n                Local data such as contacts and messages are encrypted using <b>AES-256</b>, and your PIN is used as the passphrase\n              </li>\n              <li className=\"my-2\">\n                Messages and files are encrypted using <b>Public-key authenticated encryption (box)</b> from <a className=\"underline\" href=\"https://github.com/dchest/tweetnacl-js\" target=\"_blank\">\n                https://github.com/dchest/tweetnacl-js\n                </a>. Which is implements <b>x25519-xsalsa20-poly1305</b>\n              </li>\n              <li>\n                No ads, tracking, remote server\n              </li>\n              <li>\n                Offline support\n              </li>\n              <li>\n                Compatible with services such as: <b>Messenger, Signal, Slack, Whatsapp, Twitter, Instagram DM, SMS etc</b>.\n                You can even print the cypher on a paper\n              </li>\n              <li>\n                Import export <b>encrypted backups</b>\n              </li>\n            </ul>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"py-4\">\n        <a href=\"https://github.com/enigma-reloaded/enigma-reloaded/blob/master/why-not-pgp.md\" target=\"_blank\" className=\"underline text-xl\">\n          Answer for: \"Why not use PGP, instead of this?\"\n        </a>\n      </div>\n\n      <div>\n        <div className=\"font-bold mb-2\">\n          Demo:\n        </div>\n\n        <div className=\"md:w-2/3 w-full mx-auto\">\n          <video className=\"w-full\" controls>\n            <source src={demo} type=\"video/mp4\"/>\n          </video>\n\n          <div className=\"italic text-right text-xs\">\n            <p>\n              Credits for Music: www.bensound.com\" or \"Royalty Free Music from Bensound\n            </p>\n            <p>\n              Chat app: stin.to\n            </p>\n          </div>\n        </div>\n\n        <div>\n          As you can see in the video, encrypted messages are just simple words, which you can send using existing technologies.\n        </div>\n      </div>\n\n      <div className=\"mt-12\">\n        <div className=\"font-bold mb-2\">\n          FAQ\n        </div>\n\n        <FaqQuestion title=\"What is Enigma Reloaded?\">\n          Enigma is a simple DIY(Do it yourself) program that runs inside your browser that helps you:\n          <div className=\"pl-4\">\n            <ul className=\"list-disc\">\n              <li>\n                Encrypt and decrypt messages\n              </li>\n              <li>\n                Encrypt and decrypt files\n              </li>\n              <li>\n                Store contacts and conversations\n              </li>\n            </ul>\n          </div>\n        </FaqQuestion>\n\n        <FaqQuestion title=\"Why is called Enigma?\">\n          <div>\n            It's a common name that is already associated with secrecy and privacy, and your life should be private. Enigma reloaded single purpose is to help people <a className=\"underline\"\n              href=\"https://www.youtube.com/watch?v=0hLjuVyIIrs\" target=\"_blank\">against the current Big Tech mass surveillance</a>\n          </div>\n        </FaqQuestion>\n\n        <FaqQuestion title=\"Does it have anything to do with the nazi?\">\n          No\n        </FaqQuestion>\n\n        <FaqQuestion title=\"Can big tech claims about end to end encryption be trusted?\">\n          No\n        </FaqQuestion>\n\n        <FaqQuestion title=\"Is it military grade secure?\">\n          <div className=\"pl-4\">\n            <ul className=\"list-disc\">\n              <li>\n                ✓ Strong encryption\n              </li>\n              <li>\n                ✓ Access control\n              </li>\n              <li>\n                ✓ Encrypted backups\n              </li>\n              <li>\n                ✓ No external services(except the optional gravatar for user avatars)\n              </li>\n            </ul>\n          </div>\n        </FaqQuestion>\n\n        <FaqQuestion title=\"Why did Enigma reloaded appear now?\">\n          <span className=\"underline font-bold\">Free speech on the internet must have a real chance</span> against multi trillion dollar companies and governments which try to suppress it.\n          <div>\n            2021 might be the last year when internet is not 100% censored.\n          </div>\n        </FaqQuestion>\n\n        <FaqQuestion title=\"Is it 'really' for free?\">\n          <div>\n            <div>\n              100% free, no ads, no tracking. If Enigma Reloaded helped you, that's enough. But if you want, you can donate some Monero to the project\n            </div>\n            <div className=\"break-all py-2\">\n              <b>866bdf5Dk8h2NdJBaukVpq9qwTjiiwRZWLE6e5yDXFRAcTCkozB3qDiiDoSvEQXBPhBKbXyzwxP88KkHEZBPsVui2NAKhVH</b>\n            </div>\n          </div>\n        </FaqQuestion>\n\n        <FaqQuestion title=\"Can I self host it?\">\n          <div>\n            <div>\n              Sure, just <a href=\"https://github.com/enigma-reloaded/enigma-reloaded/archive/refs/heads/gh-pages.zip\" target=\"_blank\" className=\"underline\">\n              download this zip file</a> and deploy it to your server.\n            </div>\n          </div>\n        </FaqQuestion>\n      </div>\n    </>\n  );\n}","export default __webpack_public_path__ + \"static/media/enigma-logo.d8f45653.jpg\";","import EnigmaAbout from './home-description/about';\nimport logo from '../../../assets/enigma-logo.jpg';\n\nexport default function HomePageDescription({children: button}) {\n  return (\n    <div>\n      <div className=\"flex justify-center\">\n        <img src={logo} alt=\"enigma\"/>\n      </div>\n      <div className=\"py-2\">\n        {button}\n      </div>\n\n      <EnigmaAbout/>\n    </div>\n  );\n}","import {createPortal} from 'react-dom';\nimport {useEffect, useMemo, useRef} from 'react';\nimport useOnClickOutside from 'use-onclickoutside';\n\nexport default function Modal({isOpened, close, children}) {\n  const el = useMemo(() => document.getElementById('modal-portal'), []);\n  useEffect(() => {\n    if (isOpened) {\n      return document.body.classList.add('overflow-y-hidden');\n    } else {\n      return document.body.classList.remove('overflow-y-hidden');\n    }\n  }, [isOpened]);\n  const modalContentRef = useRef(null);\n  useOnClickOutside(modalContentRef, close);\n\n  if (!isOpened) return null;\n\n  const output = (\n    <>\n      <div className=\"absolute inset-0 bg-gray-500 opacity-70\"/>\n\n      <div className=\"absolute inset-0 flex items-center py-20 overflow-y-auto px-2 md:px-0\">\n        <div className=\"md:mb-10 bg-white md:w-1/3 w-full p-4 rounded shadow mx-auto\" ref={modalContentRef}>\n          {children}\n        </div>\n      </div>\n    </>\n  );\n\n  return createPortal(output, el);\n}","import {generateKeys} from '../../lib/utils/encryption/generate-keys';\nimport {isEmpty} from 'lodash';\nimport {passwordStrength} from 'check-password-strength';\nimport {setItemInStorage, setStoragePin} from '../../lib/utils/encryption/storage';\nimport {useLocalForage} from '../../lib/hooks/use-local-forage';\nimport {useState} from '@hookstate/core';\nimport HomePageDescription from '../pages/home/home-page-description';\nimport Modal from '../utils/modal';\n\nexport default function SetupGeneratePrivateKey() {\n  const [_, setIsPrivateKeyInitialized] = useLocalForage('pk-initialized'); // eslint-disable-line no-unused-vars\n\n  const state = useState({\n    confirmMatch: true,\n    confirmPinValue: '',\n    emailValue: '',\n    nameValue: '',\n    passwordStrength: 'Too weak',\n    pinValue: '',\n    setupPinModal: false,\n  });\n  function openSetupPinModal(e) {\n    e.preventDefault();\n    state.merge({setupPinModal: true});\n  }\n\n  function closeSetupPinModal(e) {\n    e.preventDefault();\n    state.merge({setupPinModal: false});\n  }\n\n  function changePinValue(e) {\n    const value = e.target.value;\n    const strength = passwordStrength(value).value;\n    state.merge((s) => {\n      return {\n        confirmMatch: value === s.confirmPinValue,\n        passwordStrength: strength,\n        pinValue: e.target.value,\n      };\n    });\n  }\n\n  function changeConfirmPinValue(e) {\n    const value = e.target.value;\n\n    state.merge((s) => {\n      return {\n        confirmMatch: value === s.pinValue,\n        confirmPinValue: value,\n      };\n    });\n  }\n\n  function generatePrivateKey(e) {\n    e.preventDefault();\n    const keyPair = generateKeys();\n    setStoragePin(state.pinValue.get());\n    setItemInStorage('key-pair', {\n      publicKey: Array.from(keyPair.publicKey),\n      secretKey: Array.from(keyPair.secretKey),\n    });\n    setItemInStorage('name', state.nameValue.get());\n    setItemInStorage('email', state.emailValue.get().toLowerCase().replace(/\\s/g, ''));\n    setIsPrivateKeyInitialized(true);\n  }\n\n  const submitDisabled = isEmpty(state.pinValue.get()) || state.passwordStrength.get() === 'Too weak' ||\n    isEmpty(state.confirmPinValue.get()) || !state.confirmMatch.get();\n\n  function changeNameValue(e) {\n    state.merge({nameValue: e.target.value});\n  }\n\n  function changeEmailValue(e) {\n    state.merge({emailValue: e.target.value});\n  }\n\n  return (\n    <div>\n      <HomePageDescription>\n        <div className=\"flex justify-center\">\n          <button onClick={openSetupPinModal} className=\"bg-black text-white text-4xl rounded p-2\">\n            Get started\n          </button>\n        </div>\n      </HomePageDescription>\n\n      <Modal isOpened={state.setupPinModal.get()} close={closeSetupPinModal}>\n        <form className=\"pure-form pure-form-aligned\" onSubmit={generatePrivateKey}>\n          <fieldset>\n            <legend>PIN setup</legend>\n\n            <div className=\"pure-control-group\">\n              <input name=\"name\" value={state.nameValue.get()} onChange={changeNameValue} placeholder=\"Enter your name\" className=\"w-full\"/>\n              <span className=\"pure-form-message\">Optional</span>\n            </div>\n\n            <div className=\"pure-control-group\">\n              <input type=\"email\" name=\"email\" value={state.emailValue.get()} onChange={changeEmailValue} placeholder=\"Your email to have a avatar from gravatar.com\" className=\"w-full\"/>\n              <span className=\"pure-form-message\">Optional</span>\n            </div>\n\n            <div className=\"pure-control-group\">\n              <input value={state.pinValue.get()} onChange={changePinValue} placeholder=\"Enter new PIN\" className=\"w-full\"\n                autoComplete=\"nope\"\n                required/>\n              {\n                state.pinValue.get().length > 0 &&\n                 <span className=\"pure-form-message\">{state.passwordStrength.get()}</span>\n              }\n              <span className=\"pure-form-message\">You can't recover or change the PIN later. <span className=\"underline\">Make sure you remember it and keep it secret</span></span>\n            </div>\n\n            <div className=\"pure-control-group\">\n              <input value={state.confirmPinValue.get()} onChange={changeConfirmPinValue}\n                placeholder=\"Confirm your PIN\"\n                className=\"w-full\"\n                autoComplete=\"nope\"\n                required/>\n              {\n                !state.confirmMatch.get() &&\n                  <span className=\"pure-form-message text-red-500\">Pins don't match</span>\n              }\n            </div>\n\n            <button type=\"submit\" className=\"pure-button pure-button-primary w-full\" disabled={submitDisabled}>\n              Submit\n            </button>\n          </fieldset>\n        </form>\n      </Modal>\n    </div>\n  );\n}","import {box} from 'tweetnacl';\n\nexport function generateKeys() {\n  return box.keyPair();\n}","import {useEffect} from 'react';\nimport {useHistory, useLocation} from 'react-router-dom';\nimport {useLocalForage} from '../../lib/hooks/use-local-forage';\nimport SetupGeneratePrivateKey from '../setup/generate-private-key';\n\nexport function AppSetup({children}) {\n  const location = useLocation();\n  const history = useHistory();\n  const [isPrivateKeyInitialized] = useLocalForage('pk-initialized');\n  const initialized = isPrivateKeyInitialized !== null;\n  const notReady = isPrivateKeyInitialized === 'NOT_READY';\n\n  useEffect(() => {\n    if (notReady) return;\n    if (!initialized && location.pathname !== '/') {\n      history.push('/');\n    }\n  }, [location, history, notReady, initialized]);\n\n  if (notReady) return null;\n  if (initialized) return children;\n\n  return (\n    <SetupGeneratePrivateKey/>\n  );\n}","import {Link, useHistory} from 'react-router-dom';\nimport {disableStorage} from '../../lib/utils/encryption/storage';\nimport logo from '../../assets/enigma-logo.jpg';\n\nexport default function PageNavigation() {\n  const history = useHistory();\n\n  function lock(e) {\n    e.preventDefault();\n    history.push(`/unlock`);\n    setTimeout(disableStorage, 50);\n  }\n\n  return (\n    <div className=\"my-2\">\n      <div className=\"flex justify-center\">\n        <img src={logo} alt=\"enigma\"/>\n      </div>\n      <div className=\"flex flex-wrap justify-center pt-2\">\n        <NavigationItem text=\"Home\" to=\"/\"/>\n        <NavigationItem text=\"Contacts\" to=\"/contacts\"/>\n        <div className=\"pl-3\">\n          <button className=\"mx-1 text-center bg-black p-2 rounded text-white\" onClick={lock}>\n            Lock\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction NavigationItem({text, to}) {\n  return (\n    <Link to={to}>\n      <button className=\"mx-1 text-center bg-black p-2 rounded text-white\">\n        {text}\n      </button>\n    </Link>\n  );\n}","import {AppSetup} from './app-setup';\nimport {Route} from 'react-router-dom';\nimport {useRequireUnlock} from '../../lib/hooks/use-require-unlock';\nimport PageNavigation from './navigation';\n\nexport default function Unlocked({children}) {\n  const isUnlocked = useRequireUnlock();\n\n  return (\n    <div>\n      <div>\n        <PageNavigation/>\n      </div>\n      <div className=\"min-h-screen flex flex-col justify-between\">\n        {\n          isUnlocked && <div>\n            {children}\n          </div>\n        }\n\n        <div className=\"text-center pt-4\">\n          Don't be evil\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport function UnlockedRoute({children, ...opts}) {\n  return (\n    <Route {...opts}>\n      <AppSetup>\n        <Unlocked>\n          {children}\n        </Unlocked>\n      </AppSetup>\n    </Route>\n  );\n}","import {disableStorage} from '../utils/encryption/storage';\nimport {useEffect, useState} from 'react';\nimport {useHistory, useLocation} from 'react-router-dom';\nimport {useIdle} from 'react-use';\nimport {useKeyPairs} from './use-key-pairs';\n\nexport function useRequireUnlock() {\n  const history = useHistory();\n  const location = useLocation();\n  const {publicKey} = useKeyPairs();\n  const [state, setState] = useState(false);\n  const isIdle = useIdle(120e3);\n\n  useEffect(() => {\n    if (!publicKey) {\n      return history.push(`/unlock?redirectTo=${location.pathname}`);\n    }\n    setState(true);\n  }, [publicKey, setState, history, location]);\n\n  useEffect(() => {\n    if (!publicKey) return;\n    if (!isIdle) return;\n    history.push(`/unlock?redirectTo=${location.pathname}`);\n    setTimeout(disableStorage, 50);\n  }, [isIdle, publicKey, history, location.pathname]);\n\n  return state;\n}","import {Helmet, HelmetProvider} from 'react-helmet-async';\nconst pageTitle = document.title;\n\nexport function buildPageTitle(input) {\n  if (!input) return pageTitle;\n\n  return `${input} ${pageTitle}`;\n}\n\nexport default function PageTitle({children}) {\n  return (\n    <HelmetProvider>\n      <Helmet>\n        <title>{pageTitle}</title>\n      </Helmet>\n      {children}\n    </HelmetProvider>\n  );\n}","import {Helmet} from 'react-helmet-async';\nimport {buildPageTitle} from '../page/page-title';\nimport EnigmaAbout from './home/home-description/about';\n\nexport default function AboutPage() {\n  return (\n    <>\n      <Helmet>\n        <title>{buildPageTitle('About')}</title>\n      </Helmet>\n      <EnigmaAbout/>\n    </>\n  );\n}","export default function AppLayout({children}) {\n  return (\n    <div className=\"p-4\">\n      {children}\n    </div>\n  );\n}","export function downloadFile(blob, fileName) {\n  const url = window.URL.createObjectURL(blob);\n\n  const a = document.createElement('a');\n  a.href = url;\n  a.download = fileName;\n  a.classList.add('hidden');\n  document.body.appendChild(a);\n  a.click();\n  a.remove();\n\n  setTimeout(() => {\n    window.URL.revokeObjectURL(blob);\n  }, 1000);\n}","import {getItemFromStorage, setItemInStorage} from '../utils/encryption/storage';\nimport {useEffect, useState} from 'react';\n\nexport function useEncryptedStorage(keyName) {\n  const [state, setState] = useState();\n  useEffect(() => {\n    getItemFromStorage(keyName).then((value) => {\n      setState(value);\n    });\n  }, [setState, keyName]);\n\n  const setStateWrapper = (value) => {\n    setState(value);\n    setItemInStorage(keyName, value);\n  };\n\n  return [state, setStateWrapper];\n}\n\nexport function useMultipleEncryptedStorage(...keyNames) {\n  const [state, setState] = useState({});\n\n  useEffect(() => {\n    const promises = keyNames.map(async (keyName) => {\n      return {\n        keyName,\n        value: await getItemFromStorage(keyName),\n      };\n    });\n\n    Promise.all(promises).then((values) => {\n      const result = {};\n\n      values.forEach((v) => {\n        result[v.keyName] = v.value;\n      });\n\n      setState(result);\n    });\n  }, [setState, keyNames]);\n\n  return state;\n}","import {downloadFile} from '../../lib/utils/files/download-file';\nimport {exportStorage} from '../../lib/utils/encryption/storage';\nimport {useEncryptedStorage} from '../../lib/hooks/use-encrypted-storage';\nimport {useState} from '@hookstate/core';\nimport FaqQuestion from './home/home-description/faq-question';\n\nexport default function BackupPage() {\n  const [name] = useEncryptedStorage('name');\n  const state = useState({\n    buttonDisabled: false,\n  });\n\n  async function downloadBackup(e) {\n    e.preventDefault();\n    state.merge({buttonDisabled: true});\n\n    const result = await exportStorage();\n    const blob = new Blob([JSON.stringify(result)]);\n    const fileName = `${name}-enigma-backup.json`;\n\n    downloadFile(blob, fileName);\n    state.merge({buttonDisabled: false});\n  }\n\n  return (\n    <div className=\"mx-auto md:w-1/3 w-full\">\n      <div className=\"py-4\">\n        <button className=\"pure-button pure-button-primary bg-black w-full\" onClick={downloadBackup} disabled={state.buttonDisabled.get()}>\n          Download backup\n        </button>\n      </div>\n\n      <div>\n        <div className=\"font-bold\">\n          FAQ about backups\n        </div>\n\n        <FaqQuestion title=\"Can somebody restore my data with just the backup file?\">\n          No, he needs the PIN\n        </FaqQuestion>\n\n        <FaqQuestion title=\"What to do if someone got access to the program while it was PIN unlocked?\">\n          Probably your <a href=\"https://en.wikipedia.org/wiki/Public-key_cryptography\" target=\"_blank\" className=\"underline\">Private Key</a> is compromised, you should start fresh and not from a backup.\n        </FaqQuestion>\n      </div>\n    </div>\n  );\n}","export function copyToClipboard(text) {\n  const input = document.createElement('input');\n  input.setAttribute('value', text);\n  document.body.appendChild(input);\n  input.select();\n  const result = document.execCommand('copy');\n  document.body.removeChild(input);\n  return result;\n}","import {toast} from 'react-toastify';\n\nexport function feedBackSuccess(message) {\n  toast.success(message);\n}","import {randomNumber} from '../numbers/random-number';\n\nexport function undetectableSplitString(str) {\n  let output = '';\n  const strLng = str.length;\n  let nextWordSize;\n\n  for (let i = 0; i < strLng; i++) {\n    if (!nextWordSize) {\n      nextWordSize = randomNumber(1, 10);\n    }\n\n    output += str[i];\n    nextWordSize -= 1;\n\n    if (!nextWordSize) {\n      output += ' ';\n    }\n  }\n\n  return output;\n}","export function randomNumber(min, max) {\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}","import {copyToClipboard} from '../utils/actions/copy-to-clipboard';\nimport {feedBackSuccess} from '../feedback/success';\nimport {getItemFromStorage, setItemInStorage} from '../utils/encryption/storage';\nimport {isEmpty} from 'lodash';\nimport {none} from '@hookstate/core';\nimport {undetectableSplitString} from '../utils/undetectable/split-string';\nimport {v4 as uuidv4} from 'uuid';\n\nexport class PrivateMessageRecord {\n  constructor({id, messageRaw, encryptedMessage, contact, createdAt, mine}) {\n    this.id = id;\n    this.messageRaw = messageRaw;\n    this.encryptedMessage = encryptedMessage;\n    this.contact = contact;\n    this.createdAt = createdAt;\n    this.mine = mine;\n  }\n\n  copyToClipBoard() {\n    copyToClipboard(undetectableSplitString(this.encryptedMessage));\n    feedBackSuccess('Encrypted message copied to clipboard');\n  }\n\n  async save() {\n    this.contact.messages.set((m) => {\n      m.splice(0, 0, this);\n      return m;\n    });\n    const key = `private-messages-${this.contact.id.get()}`;\n\n    let rawMessages = await getItemFromStorage(key);\n    if (isEmpty(rawMessages)) rawMessages = [];\n\n    rawMessages.splice(0, 0, this.serialize());\n\n    setItemInStorage(key, rawMessages);\n  }\n\n  serialize() {\n    return {\n      createdAt: this.createdAt,\n      encryptedMessage: this.encryptedMessage.substring(0, 8),\n      id: this.id,\n      messageRaw: this.messageRaw,\n      mine: this.mine,\n    };\n  }\n\n  async destroy(contact) {\n    const contactIndex = contact.messages.findIndex((message) => {\n      return message.id.get() === this.id;\n    });\n\n    const key = `private-messages-${contact.id.get()}`;\n\n    let rawMessages = await getItemFromStorage(key);\n    rawMessages = rawMessages.filter((message) => {\n      return message.id !== this.id;\n    });\n\n    contact.messages.merge({\n      [contactIndex]: none,\n    });\n\n    setItemInStorage(key, rawMessages);\n  }\n}\n\nexport async function createNewPrivateMessageRecord(messageRaw, encryptedMessage, contact) {\n  const createdAt = new Date().toISOString();\n  const id = uuidv4();\n  const mine = true;\n  const record = new PrivateMessageRecord({\n    contact, createdAt, encryptedMessage,\n    id, messageRaw, mine,\n  });\n\n  await record.save();\n\n  return record;\n}\n\nexport async function insertDecryptedMessageRecord(messageRaw, encryptedMessage, contact) {\n  const createdAt = new Date().toISOString();\n  const id = uuidv4();\n  const mine = false;\n  const record = new PrivateMessageRecord({\n    contact, createdAt, encryptedMessage,\n    id, messageRaw, mine,\n  });\n\n  await record.save();\n\n  return record;\n}\n\nexport async function destroyMessageRecord(messageRecord) {\n  return messageRecord.destroy();\n}","import {PrivateMessageRecord} from './private-message-record';\nimport {getItemFromStorage} from '../utils/encryption/storage';\nimport {isEmpty} from 'lodash';\n\nexport async function loadPrivateMessagesForContact(contact) {\n  const key = `private-messages-${contact.id}`;\n\n  const rawMessages = await getItemFromStorage(key);\n\n  if (isEmpty(rawMessages)) return [];\n\n  return rawMessages.map((m) => {\n    const message = new PrivateMessageRecord(m);\n    message.contact = contact;\n    return message;\n  });\n}","import {loadPrivateMessagesForContact} from '../private-messages/private-messages-store';\nimport {removeContact, saveContact} from './contacts-store';\n\nexport class RecordContact {\n  constructor({id, name, emailHash, publicKey}) {\n    this.id = id;\n    this.name = name;\n    this.emailHash = emailHash;\n    this.publicKey = publicKey;\n    this.messages = [];\n  }\n\n  save() {\n    return saveContact(this);\n  }\n\n  destroy() {\n    return removeContact(this);\n  }\n\n  serialize() {\n    return {\n      emailHash: this.emailHash, id: this.id,\n      name: this.name, publicKey: this.publicKey,\n    };\n  }\n\n  serializeWithoutId() {\n    const result = this.serialize();\n    delete result.id;\n    return result;\n  }\n\n  async loadPrivateMessages(hookstate) {\n    hookstate.messages.set(await loadPrivateMessagesForContact(this));\n  }\n}","import {RecordContact} from './record-contact';\nimport {createState} from '@hookstate/core';\nimport {deleteItemInStorage, getItemFromStorage, setItemInStorage} from '../utils/encryption/storage';\nimport {isEmpty, sortBy} from 'lodash';\nimport {none} from '@hookstate/core';\n\nlet loadedFromStorage;\n\nexport const contactsStore = createState({\n  contacts: [],\n});\n\nexport function saveContact(contactRecord) {\n  getItemFromStorage('contacts').then((contacts) => {\n    if (isEmpty(contacts)) contacts = [];\n\n    const existingContact = contacts.find((c) => {\n      return c.publicKey === contactRecord.publicKey;\n    });\n    if (existingContact) {\n      Object.assign(existingContact, contactRecord.serializeWithoutId());\n      const storeContact = contactsStore.contacts.find((contact) => {\n        return contact.publicKey.get() === contactRecord.publicKey;\n      });\n\n      storeContact.merge(contactRecord.serializeWithoutId());\n    } else {\n      contactsStore.contacts.set((c) => {\n        c.splice(0, 0, contactRecord);\n        return c;\n      });\n      contacts.splice(0, 0, contactRecord.serialize());\n    }\n\n    setItemInStorage('contacts', contacts);\n  });\n}\n\nexport async function removeContact(contactRecord) {\n  let contacts = await getItemFromStorage('contacts');\n  const {id} = contactRecord;\n  if (isEmpty(contacts)) return;\n  contacts = contacts.filter((contact) => {\n    return contact.publicKey !== contactRecord.publicKey;\n  });\n\n  const contactIndex = contactsStore.contacts.findIndex((contact) => {\n    return contact.publicKey.get() === contactRecord.publicKey;\n  });\n\n  if (contactIndex !== undefined) contactsStore.contacts[contactIndex].set(none);\n\n  await setItemInStorage('contacts', contacts);\n  await deleteItemInStorage(`private-messages-${id}`);\n}\n\nexport async function getContactsStore() {\n  if (loadedFromStorage) {\n    return contactsStore;\n  }\n\n  loadedFromStorage = true;\n  let contacts = await getItemFromStorage('contacts');\n  if (isEmpty(contacts)) return contactsStore;\n\n  contacts = contacts.map((c) => {\n    return new RecordContact(c);\n  });\n\n  const sortedContacts = sortBy(contacts, 'name');\n\n  contactsStore.merge({contacts: sortedContacts});\n\n  return contactsStore;\n}\n\nexport async function getContact(id) {\n  const contactStore = await getContactsStore();\n\n  const record = contactStore.contacts.find((contact) => {\n    return contact.id.get() === id;\n  });\n\n  if (!record.get()) return {};\n\n  return new RecordContact(JSON.parse(JSON.stringify(record.get())));\n}","export default __webpack_public_path__ + \"static/media/user-placeholder.1bd594c3.svg\";","import {isEmpty} from 'lodash';\nimport {useLocalForage} from '../../lib/hooks/use-local-forage';\nimport userPlaceholder from '../../assets/user-placeholder.svg';\n\nexport default function ContactAvatar({emailHash, contact, height, width}) {\n  const [gravatarEnabled] = useLocalForage('gravatar-enabled');\n  if (gravatarEnabled === 'NOT_READY') return null;\n\n  const displayedEmailHash = emailHash || contact.emailHash.get();\n  let src;\n  if (isEmpty(displayedEmailHash) || !gravatarEnabled) {\n    src = userPlaceholder;\n  } else {\n    src = `http://www.gravatar.com/avatar/${displayedEmailHash}`;\n  }\n\n  return (\n    <img src={src} className={`rounded-full ${height} ${width}`}/>\n  );\n}","import {feedBackSuccess} from '../../../lib/feedback/success';\nimport {useState} from '@hookstate/core';\nimport Modal from '../../utils/modal';\n\nexport default function EditContact({contact}) {\n  const state = useState({\n    modalIsOpened: false,\n  });\n  function closeModal() {\n    state.merge({modalIsOpened: false});\n  }\n\n  function openModal(e) {\n    e.preventDefault();\n    state.merge({modalIsOpened: true});\n  }\n\n  function save(e) {\n    e.preventDefault();\n    closeModal();\n    contact.get().save();\n    feedBackSuccess('Contact saved');\n  }\n\n  function changeNameValue(e) {\n    contact.merge({name: e.target.value});\n  }\n\n  return (\n    <>\n      <button className=\"underline\" onClick={openModal}>\n        Edit\n      </button>\n\n      <Modal isOpened={state.modalIsOpened.get()} close={closeModal}>\n        <form className=\"pure-form pure-form-aligned\" onSubmit={save}>\n          <fieldset>\n            <legend>Edit {contact.name.get()}</legend>\n          </fieldset>\n\n          <div className=\"pure-control-group\">\n            <input name=\"name\" value={contact.name.get()} onChange={changeNameValue} placeholder=\"Name\" className=\"w-full\" required/>\n          </div>\n\n          <button type=\"submit\" className=\"pure-button pure-button-primary w-full bg-black\">\n            Save\n          </button>\n        </form>\n      </Modal>\n    </>\n  );\n}","import {getItemFromStorage} from './storage';\nimport {isEmpty} from 'lodash';\n\nlet privateKey;\nlet publicKey;\n\nexport async function getPrivateKey() {\n  if (!isEmpty(privateKey)) return privateKey;\n  const pk = await getItemFromStorage('key-pair');\n  if (isEmpty(pk)) return;\n  return privateKey = Uint8Array.from(pk.secretKey);\n}\n\nexport async function getPublicKey() {\n  if (!isEmpty(publicKey)) return publicKey;\n  const pk = await getItemFromStorage('key-pair');\n  if (isEmpty(pk)) return;\n  return publicKey = Uint8Array.from(pk.publicKey);\n}","import {\n  encodeBase64,\n} from 'tweetnacl-util';\nimport {isEmpty} from 'lodash';\n\nexport function formatToBase64Undetectable(string) {\n  if (isEmpty(string)) return;\n\n  const output = encodeBase64(string);\n\n  return output.replace(/=/g, '');\n}","import {box, randomBytes} from 'tweetnacl';\nimport {decodeBase64, decodeUTF8} from 'tweetnacl-util';\nimport {formatToBase64Undetectable} from '../undetectable/format-to-base-64-undetectable';\nimport {getPrivateKey} from './keys';\nimport {sample} from 'lodash';\n\nexport async function encryptMessage(publicKeyString, messageString) {\n  const pubKeyUInt8Array = decodeBase64(publicKeyString);\n  const msgUInt8Array = decodeUTF8(messageString);\n  const nonce = randomBytes(box.nonceLength);\n\n  const encryptedMessage = box(\n      msgUInt8Array,\n      nonce,\n      pubKeyUInt8Array,\n      await getPrivateKey(),\n  );\n  return formatToBase64Undetectable(encryptedMessage) + formatNonce(nonce);\n}\n\nfunction formatNonce(nonce) {\n  const char = sample(['?', '!', '.', ',']);\n\n  return char + formatToBase64Undetectable(nonce);\n}","import {Editor, EditorState, convertToRaw} from 'draft-js';\nimport {createNewPrivateMessageRecord} from '../../../lib/private-messages/private-message-record';\nimport {encryptMessage} from '../../../lib/utils/encryption/encrypt-message';\nimport {useState as reactUseState, useEffect, useRef} from 'react';\nimport {useState} from '@hookstate/core';\nimport Modal from '../../utils/modal';\n\nexport default function CreateNewPrivateMessage({contact}) {\n  const editorRef = useRef();\n  const state = useState({\n    modalIsOpened: false,\n  });\n\n  useEffect(() => {\n    if (!state.modalIsOpened.get()) return;\n    editorRef.current.focus();\n  }, [state.modalIsOpened.get()]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const [editorState, setEditorState] = reactUseState(\n      () => EditorState.createEmpty(),\n  );\n\n  function openModal(e) {\n    e.preventDefault();\n    state.merge({modalIsOpened: true});\n  }\n\n  function closeModal() {\n    state.merge({modalIsOpened: false});\n  }\n\n  async function save(e) {\n    e.preventDefault();\n    let rawContent = convertToRaw(editorState.getCurrentContent());\n    rawContent = rawContent.blocks.map((block) => (!block.text.trim() && '\\n') || block.text).join('\\n');\n    const encryptedMessage = await encryptMessage(contact.publicKey.get(), rawContent);\n    const record = await createNewPrivateMessageRecord(rawContent, encryptedMessage, contact);\n\n    state.merge({modalIsOpened: false});\n    setEditorState(EditorState.createEmpty());\n\n    record.copyToClipBoard();\n  }\n\n  return (\n    <>\n      <button className=\"pure-button pure-button-primary bg-black w-full\" onClick={openModal}>\n        Encrypt message\n      </button>\n\n      <Modal isOpened={state.modalIsOpened.get()} close={closeModal}>\n        <form onSubmit={save}>\n          <div className=\"border-gray-300 border border-solid p-2\">\n            <Editor editorState={editorState} onChange={setEditorState} placeholder=\"Type your message\" ref={editorRef}/>\n          </div>\n\n          <div className=\"flex justify-end my-2\">\n            <button type=\"submit\" className=\"pure-button pure-button-primary bg-black\" disabled={!editorState.getCurrentContent().hasText()}>\n              Encrypt message\n            </button>\n          </div>\n        </form>\n      </Modal>\n    </>\n  );\n}","import {decodeBase64} from 'tweetnacl-util';\n\nexport function decodeBase64Undetectable(base64String) {\n  return decodeBase64(restoreBase64String(base64String));\n}\n\nexport function restoreBase64String(base64StringUndetectable) {\n  if (base64StringUndetectable.length % 4 !== 0) {\n    base64StringUndetectable += ('===').slice(0, 4 - (base64StringUndetectable.length % 4));\n  }\n\n  return base64StringUndetectable;\n}","import {box} from 'tweetnacl';\nimport {decodeBase64, encodeUTF8} from 'tweetnacl-util';\nimport {decodeBase64Undetectable} from '../undetectable/decode-base-64-undetectable';\nimport {getPrivateKey} from './keys';\nimport {isEmpty} from 'lodash';\n\nexport async function decryptMessage(publicKeyString, encryptedString) {\n  const [encryptedMessageString, nonceString] = encryptedString.split(/\\?|!|\\.|,/);\n  if (isEmpty(encryptedMessageString) || isEmpty(nonceString)) throw new Error('Invalid encrypted message');\n  const pubKeyUInt8Array = decodeBase64(publicKeyString);\n  const nonce = decodeBase64Undetectable(nonceString);\n  const encryptedMessage = decodeBase64Undetectable(encryptedMessageString);\n  const decryptedMessage = box.open(encryptedMessage, nonce, pubKeyUInt8Array, await getPrivateKey());\n  return encodeUTF8(decryptedMessage);\n}","import {Editor, EditorState, convertToRaw} from 'draft-js';\nimport {decryptMessage} from '../../../lib/utils/encryption/decrypt-message';\nimport {feedBackSuccess} from '../../../lib/feedback/success';\nimport {feedbackError} from '../../../lib/feedback/error';\nimport {\n  insertDecryptedMessageRecord,\n} from '../../../lib/private-messages/private-message-record';\nimport {useState as reactUseState, useEffect, useRef} from 'react';\nimport {useState} from '@hookstate/core';\nimport Modal from '../../utils/modal';\n\nexport default function DecodeNewPrivateMessage({contact}) {\n  const editorRef = useRef();\n  const state = useState({\n    modalIsOpened: false,\n  });\n\n  useEffect(() => {\n    if (!state.modalIsOpened.get()) return;\n    editorRef.current.focus();\n  }, [state.modalIsOpened.get()]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const [editorState, setEditorState] = reactUseState(\n      () => EditorState.createEmpty(),\n  );\n\n  function openModal(e) {\n    e.preventDefault();\n    state.merge({modalIsOpened: true});\n  }\n\n  function closeModal() {\n    state.merge({modalIsOpened: false});\n  }\n\n  async function decrypt(e) {\n    e.preventDefault();\n    let encryptedContentRaw = convertToRaw(editorState.getCurrentContent());\n    encryptedContentRaw = encryptedContentRaw.blocks.map((block) => (!block.text.trim() && '\\n') || block.text)\n        .join('').replace(/\\s/g, '');\n    let messageRaw;\n    try {\n      messageRaw = await decryptMessage(contact.publicKey.get(), encryptedContentRaw);\n    } catch {\n      return feedbackError('Invalid encrypted message');\n    }\n    await insertDecryptedMessageRecord(messageRaw, encryptedContentRaw, contact);\n    state.merge({modalIsOpened: false});\n    setEditorState(EditorState.createEmpty());\n\n    feedBackSuccess('Message decrypted!');\n  }\n\n  return (\n    <>\n      <button className=\"pure-button pure-button-primary bg-black w-full\" onClick={openModal}>\n        Decrypt message\n      </button>\n\n      <Modal isOpened={state.modalIsOpened.get()} close={closeModal}>\n        <form onSubmit={decrypt}>\n          <div className=\"border-gray-300 border border-solid p-2\">\n            <Editor editorState={editorState} onChange={setEditorState} placeholder=\"Paste the encrypted message\" ref={editorRef}/>\n          </div>\n\n          <div className=\"flex justify-end my-2\">\n            <button type=\"submit\" className=\"pure-button pure-button-primary pure-button-primary bg-black\" disabled={!editorState.getCurrentContent().hasText()}>\n              Decrypt message\n            </button>\n          </div>\n        </form>\n      </Modal>\n    </>\n  );\n}","import {box} from 'tweetnacl';\nimport {decodeBase64} from 'tweetnacl-util';\nimport {decodeBase64Undetectable} from '../undetectable/decode-base-64-undetectable';\nimport {getPrivateKey} from './keys';\nimport {isEmpty} from 'lodash';\nimport {v4 as uuidv4} from 'uuid';\n\nexport async function decryptFile(publicKeyString, encryptedFile) {\n  const match = encryptedFile.name.match(/-(.*)\\.txt$/);\n  if (isEmpty(match)) throw new Error('Invalid encrypted file');\n  const [fullExtension, extension] = match;\n\n  const nonce = decodeBase64Undetectable(encryptedFile.name.replace(fullExtension, ''));\n  const pubKeyUInt8Array = decodeBase64(publicKeyString);\n\n  const decryptedFileInt8 = box.open(new Uint8Array(await encryptedFile.arrayBuffer()), nonce, pubKeyUInt8Array, await getPrivateKey());\n\n  const decryptedFile = new Blob([decryptedFileInt8], {\n    type: 'application/octet-stream',\n  });\n\n  return {\n    decryptedFile,\n    fileName: `${uuidv4()}.${extension}`,\n  };\n}","import {decryptFile} from '../../../lib/utils/encryption/decrypt-file';\nimport {downloadFile} from '../../../lib/utils/files/download-file';\nimport {feedBackSuccess} from '../../../lib/feedback/success';\nimport {feedbackError} from '../../../lib/feedback/error';\nimport {useRef} from 'react';\nimport {useState} from '@hookstate/core';\nimport Modal from '../../utils/modal';\n\nexport default function DecryptFile({contact}) {\n  const inputRef = useRef();\n  const state = useState({\n    fileProcessing: false,\n    modalIsOpened: false,\n  });\n\n  function openModal(e) {\n    e.preventDefault();\n    state.merge({modalIsOpened: true});\n  }\n\n  function closeModal() {\n    if (state.fileProcessing.get()) return;\n    state.merge({modalIsOpened: false});\n  }\n\n  async function decrypt(e) {\n    e.preventDefault();\n    state.merge({\n      fileProcessing: true,\n    });\n\n    try {\n      const {decryptedFile, fileName} = await decryptFile(contact.publicKey.get(), e.target.files[0]);\n      downloadFile(decryptedFile, fileName);\n    } catch {\n      e.target.value = '';\n      state.merge({fileProcessing: false});\n      return feedbackError('Unable to decrypt file');\n    }\n\n    e.target.value = '';\n\n    state.merge({\n      fileProcessing: false,\n      modalIsOpened: false,\n    });\n\n    feedBackSuccess('File ready');\n  }\n\n  function selectFile(e) {\n    e.preventDefault();\n    inputRef.current.click();\n  }\n\n  return (\n    <>\n      <button className=\"pure-button pure-button-primary bg-black w-full\" onClick={openModal}>\n        Decrypt file\n      </button>\n\n      <Modal isOpened={state.modalIsOpened.get()} close={closeModal}>\n        <input type=\"file\" className=\"hidden\" ref={inputRef} onChange={decrypt}/>\n\n        <div className=\"my-1\">\n          As soon as the file is decrypted, you can download it\n        </div>\n\n        <button className=\"pure-button pure-button-primary bg-black w-full\" onClick={selectFile} disabled={state.fileProcessing.get()}>\n          Select encrypted file\n        </button>\n      </Modal>\n    </>\n  );\n}","import {box, randomBytes} from 'tweetnacl';\nimport {decodeBase64} from 'tweetnacl-util';\nimport {formatToBase64Undetectable} from '../undetectable/format-to-base-64-undetectable';\nimport {getPrivateKey} from './keys';\n\nexport async function encryptFile(publicKeyString, file) {\n  const nonce = randomBytes(box.nonceLength);\n  const pubKeyUInt8Array = decodeBase64(publicKeyString);\n\n  const outputFileIntArray = box(\n      new Uint8Array(await file.arrayBuffer()),\n      nonce,\n      pubKeyUInt8Array,\n      await getPrivateKey(),\n  );\n\n  const outputFile = new Blob([outputFileIntArray], {\n    type: 'application/octet-stream',\n  });\n  const extension = file.name.split('.').pop();\n\n  return {\n    fileName: `${formatToBase64Undetectable(nonce)}-${extension}.txt`,\n    outputFile,\n  };\n}","import {downloadFile} from '../../../lib/utils/files/download-file';\nimport {encryptFile} from '../../../lib/utils/encryption/encrypt-file';\nimport {feedBackSuccess} from '../../../lib/feedback/success';\nimport {useRef} from 'react';\nimport {useState} from '@hookstate/core';\nimport Modal from '../../utils/modal';\n\nexport default function EncryptFile({contact}) {\n  const inputRef = useRef();\n  const state = useState({\n    fileProcessing: false,\n    modalIsOpened: false,\n  });\n\n  function openModal(e) {\n    e.preventDefault();\n    state.merge({modalIsOpened: true});\n  }\n\n  function closeModal() {\n    if (state.fileProcessing.get()) return;\n    state.merge({modalIsOpened: false});\n  }\n\n  async function encrypt(e) {\n    e.preventDefault();\n    state.merge({\n      fileProcessing: true,\n    });\n\n    const {outputFile, fileName} = await encryptFile(contact.publicKey.get(), e.target.files[0]);\n    e.target.value = '';\n\n    downloadFile(outputFile, fileName);\n\n    state.merge({\n      fileProcessing: false,\n      modalIsOpened: false,\n    });\n\n    feedBackSuccess('File encrypted');\n  }\n\n  function selectFile(e) {\n    e.preventDefault();\n    inputRef.current.click();\n  }\n\n  return (\n    <>\n      <button className=\"pure-button pure-button-primary bg-black w-full\" onClick={openModal}>\n        Encrypt file\n      </button>\n\n      <Modal isOpened={state.modalIsOpened.get()} close={closeModal}>\n        <input type=\"file\" className=\"hidden\" ref={inputRef} onChange={encrypt}/>\n\n        <div className=\"my-1\">\n          As soon as the file is encrypted you will download it, <span className=\"font-bold\">do not rename it</span>\n        </div>\n\n        <button className=\"pure-button pure-button-primary bg-black w-full\" onClick={selectFile} disabled={state.fileProcessing.get()}>\n          Select unencrypted file\n        </button>\n      </Modal>\n    </>\n  );\n}","export function mergeStyles(...input) {\n  const output = [];\n  input.forEach((blockOfClasses) => {\n    if (!blockOfClasses) return;\n    blockOfClasses.split(/\\s/g).forEach((className) => {\n      if (className.length > 0) output.push(className);\n    });\n  });\n\n  return output.join(' ');\n}","import {feedBackSuccess} from '../../../lib/feedback/success';\nimport {mergeStyles} from '../../../lib/utils/string/merge-styles';\nimport TimeAgo from 'timeago-react';\n\nexport default function Message({message, contact}) {\n  const {messageRaw, createdAt, mine, encryptedMessage} = message;\n  let ownerClassContainer; let ownerClass;\n\n  if (mine.get()) {\n    ownerClassContainer = 'justify-end pl-20';\n    ownerClass = 'text-right';\n  } else {\n    ownerClassContainer = 'pr-20';\n    ownerClass = 'bg-green-300';\n  }\n\n  function destroy(e) {\n    e.preventDefault();\n\n    message.get().destroy(contact);\n\n    feedBackSuccess('Message removed');\n  }\n\n  return (\n    <div className={mergeStyles('flex', ownerClassContainer)}>\n      <div className={mergeStyles('whitespace-pre-wrap my-1 p-2 border border-solid border-gray-300 rounded break-all', ownerClass)}>\n        {messageRaw.get()}\n\n        <div className={mergeStyles('pt-1')}>\n          <TimeAgo datetime={createdAt.get()}/>\n        </div>\n\n        <div className=\"text-xs border-solid border-gray-300 border-t p-1\">\n          #{encryptedMessage.get().substring(0, 8)}\n          <button className=\"ml-1 text-red-500\" onClick={destroy}>\n            (x)\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}","import {copyToClipboard} from '../../../lib/utils/actions/copy-to-clipboard';\nimport {formatKeyReadable} from '../../../lib/utils/format/keys';\nimport {formatToBase64Undetectable} from '../../../lib/utils/undetectable/format-to-base-64-undetectable';\nimport {md5} from '../../../lib/utils/format/md5';\nimport {stringToU8} from '../../../lib/utils/format/string-to-u8';\nimport {undetectableSplitString} from '../../../lib/utils/undetectable/split-string';\nimport {useEffect} from 'react';\nimport {useKeyPairs} from '../../../lib/hooks/use-key-pairs';\nimport {useMultipleEncryptedStorage} from '../../../lib/hooks/use-encrypted-storage';\nimport {useState} from '@hookstate/core';\nlet copyTimeout;\n\nexport default function ShowSharablePublicKey() {\n  const {publicKey} = useKeyPairs();\n  const readableKey = formatKeyReadable(publicKey);\n  const {name, email} = useMultipleEncryptedStorage('name', 'email');\n\n  const encodedName = name ? formatToBase64Undetectable(stringToU8(name)) : '';\n  const encodedEmail = email ? md5(email) : '';\n  const output = `${readableKey}.${encodedName}.${encodedEmail}`;\n  const state = useState({\n    showCopied: false,\n  });\n\n  useEffect(() => {\n    return () => {\n      if (copyTimeout) clearTimeout(copyTimeout);\n    };\n  }, []);\n\n  if (!readableKey) return null;\n  if (name === undefined || email === undefined) return null;\n\n  function copyPk(e) {\n    e.preventDefault();\n    const undetectableStr = undetectableSplitString(output);\n    copyToClipboard(undetectableStr);\n    state.merge({showCopied: true});\n\n    copyTimeout = setTimeout(() => {\n      state.merge({showCopied: false});\n    }, 1500);\n  }\n\n  return (\n    <div className=\"p-3\">\n      <button className=\"text-center bg-gray-300 hover:bg-gray-200 rounded p-2 border border-solid border-gray-300\" onClick={copyPk}>\n        <div className=\"font-bold\">\n          My public key, name and email hashed\n        </div>\n        <div className=\"break-all\">\n          {\n            state.showCopied.get() ? 'Copied' : output\n          }\n        </div>\n\n        <div className=\"text-right text-sm\">\n          Click to copy\n        </div>\n      </button>\n    </div>\n  );\n}","import {useEffect, useRef} from 'react';\nimport CreateNewPrivateMessage from './create-new-private-message';\nimport DecodeNewPrivateMessage from './decode-new-private-message';\nimport DecryptFile from './decrypt-file';\nimport EncryptFile from './encrypt-file';\nimport Message from './message';\nimport ViewportList from 'react-viewport-list';\n\nexport default function PrivateMessages({contact}) {\n  const ref = useRef(null);\n\n  useEffect(() => {\n    if (contact.messages.length > 0) return;\n    contact.get().loadPrivateMessages(contact);\n  }, [contact.id.get()]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  return (\n    <div>\n      <div className=\"text-lg italic\">\n        Private messages\n      </div>\n\n      <div className=\"py-2 flex justify-between\">\n        <div className=\"w-1/2 pr-1\">\n          <DecodeNewPrivateMessage contact={contact}/>\n\n          <div className=\"pt-1\">\n            <DecryptFile contact={contact}/>\n          </div>\n        </div>\n        <div className=\"w-1/2 pl-1\">\n          <CreateNewPrivateMessage contact={contact}/>\n          <div className=\"pt-1\">\n            <EncryptFile contact={contact}/>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"scroll-container\" ref={ref}>\n        <ViewportList\n          viewportRef={ref}\n          items={contact.messages}\n          itemMinSize={20}\n        >\n          {(message) => (\n            <div key={message.id.get()} className=\"item\">\n              <Message message={message} contact={contact}/>\n            </div>\n          )}\n        </ViewportList>\n      </div>\n    </div>\n  );\n}","export default function PublicMessages() {\n  return (\n    <div>\n      public\n    </div>\n  );\n}","import {Helmet} from 'react-helmet-async';\nimport {Link, Route, Switch, useParams, useRouteMatch} from 'react-router-dom';\nimport {buildPageTitle} from '../page/page-title';\nimport {getContact} from '../../lib/contacts/contacts-store';\nimport {useEffect} from 'react';\nimport {useState} from '@hookstate/core';\nimport ContactAvatar from '../contacts/avatar';\nimport EditContact from './contact/edit-contact';\nimport PrivateMessages from './contact/private-messages';\nimport PublicMessages from './contact/public-messages';\n\nexport default function ContactPage() {\n  const {id} = useParams();\n  const {path, url} = useRouteMatch();\n  const state = useState({\n    contact: null,\n    ready: false,\n  });\n\n  useEffect(() => {\n    getContact(id).then((contact) => {\n      state.merge({\n        contact,\n        ready: true,\n      });\n    });\n  }, [id]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const {contact, ready} = state;\n\n  if (!contact?.id?.get() && !ready.get()) return null;\n\n  if (!contact?.id?.get()) {\n    return (\n      <>\n        <Helmet>\n          <title>{buildPageTitle('Contact not found')}</title>\n        </Helmet>\n        <div>\n          Contact not found\n        </div>\n      </>\n    );\n  }\n\n  return (\n    <>\n      <Helmet>\n        <title>{buildPageTitle(contact.name.get())}</title>\n      </Helmet>\n      <div className=\"w-full md:w-1/3 mx-auto\">\n        <div>\n          <div className=\"flex justify-center pb-2\">\n            <ContactAvatar contact={contact} height=\"h-20\" width=\"w-20\"/>\n          </div>\n          <div className=\"flex flex-wrap justify-center items-center\">\n            <h1 className=\"text-right pr-1\">{contact.name.get()}</h1>\n            <div className=\"pl-1\">\n              <EditContact contact={contact}/>\n            </div>\n          </div>\n\n          <div>\n            <div className=\"my-1 flex justify-center\">\n              <div className=\"px-1 underline\">\n                <Link to={`${url}`}>Private Messages</Link>\n              </div>\n              <div className=\"px-1 underline\">\n                <Link to={`${url}/public-messages`}>Public Messages</Link>\n              </div>\n            </div>\n\n            <Switch>\n              <Route exact path={path}>\n                <PrivateMessages contact={contact}/>\n              </Route>\n\n              <Route path={`${path}/public-messages`}>\n                <PublicMessages />\n              </Route>\n            </Switch>\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}","import {importContactFromString} from '../../../lib/contacts/import-contact-from-string';\nimport {isEmpty} from 'lodash';\nimport {useState} from '@hookstate/core';\nimport Modal from '../../utils/modal';\n\nexport function AddNewContact() {\n  const state = useState({\n    inputPkNameEmail: '',\n    modalOpened: false,\n  });\n\n  function closeModal() {\n    state.merge({modalOpened: false});\n  }\n\n  function addNewContact(e) {\n    e.preventDefault();\n    importContactFromString(state.inputPkNameEmail.get());\n    state.merge({\n      inputPkNameEmail: '',\n      modalOpened: false,\n    });\n  }\n\n  function changeInputPkNameEmail(e) {\n    const {value} = e.target;\n    state.merge({inputPkNameEmail: value});\n  }\n\n  function openModal(e) {\n    e.preventDefault();\n    state.merge({modalOpened: true});\n  }\n\n  return (\n    <div>\n      <button className=\"bg-black text-white p-3\" onClick={openModal}>\n        + Add new contact\n      </button>\n\n      <Modal isOpened={state.modalOpened.get()} close={closeModal}>\n        <form className=\"pure-form pure-form-aligned\" onSubmit={addNewContact}>\n          <fieldset>\n            <legend>Contact public key, name and email hashed</legend>\n\n            <div className=\"pure-control-group\">\n              <input name=\"inputPkNameEmail\" value={state.inputPkNameEmail.get()} onChange={changeInputPkNameEmail} placeholder=\"Paste the contact code\"\n                autoComplete=\"nope\"\n                className=\"w-full\"\n              />\n            </div>\n\n            <button type=\"submit\" className=\"pure-button pure-button-primary bg-black w-full\" disabled={isEmpty(state.inputPkNameEmail.get())}>\n              Add\n            </button>\n          </fieldset>\n        </form>\n      </Modal>\n    </div>\n  );\n}","import {isEmpty} from 'lodash';\nimport {v4 as uuidv4} from 'uuid';\n\nimport {RecordContact} from './record-contact';\nimport {restoreBase64String} from '../utils/undetectable/decode-base-64-undetectable';\n\nexport function importContactFromString(str) {\n  let [publicKey, name, emailHash] = str.replace(/\\s/g, '').split('.');\n  name = atob(name);\n\n  name = isEmpty(name) ? 'Unknown user' : name;\n\n  const record = new RecordContact({\n    emailHash, id: uuidv4(), name, publicKey: restoreBase64String(publicKey),\n  });\n  record.save();\n}","import {Link} from 'react-router-dom';\nimport ContactAvatar from '../../contacts/avatar';\n\nexport default function ContactListItem({contact}) {\n  function destroyContact(e) {\n    e.preventDefault();\n    contact.get().destroy();\n  }\n\n  return (\n    <div className=\"flex flex-wrap items-center justify-between p-2 bg-gray-300 my-2 rounded\">\n      <div>\n        <Link to={`/contacts/${contact.id.get()}`}>\n          <div className=\"flex items-center\">\n            <ContactAvatar contact={contact} height=\"h-20\" width=\"w-20\"/>\n            <span className=\"pl-2\">\n              {contact.name.get()}\n            </span>\n          </div>\n        </Link>\n      </div>\n\n      <div>\n        <button onClick={destroyContact}>\n          Remove\n        </button>\n      </div>\n    </div>\n  );\n}","import {contactsStore} from '../../../lib/contacts/contacts-store';\nimport {useRef} from 'react';\nimport {useState} from '@hookstate/core';\nimport ContactListItem from './contact-list-item';\nimport ViewportList from 'react-viewport-list';\n\nexport default function ContactsList() {\n  const state = useState(contactsStore);\n  const ref = useRef(null);\n\n  return (\n    <div className=\"scroll-container\" ref={ref}>\n      <ViewportList\n        viewportRef={ref}\n        items={state.contacts}\n        itemMinSize={20}\n      >\n        {(contact) => (\n          <div key={contact.id.get()} className=\"item\">\n            <ContactListItem contact={contact}/>\n          </div>\n        )}\n      </ViewportList>\n    </div>\n  );\n}","import {getContactsStore} from '../../../lib/contacts/contacts-store';\nimport {useEffect, useState} from 'react';\n\nexport default function ContactsStoreLoader({children}) {\n  const [contactsStore, setContactsStore] = useState();\n  useEffect(() => {\n    getContactsStore().then((c) => {\n      setContactsStore(c);\n    });\n  }, [setContactsStore]);\n\n  if (!contactsStore) return null;\n\n  return children;\n}","import {useLocalForage} from '../../../lib/hooks/use-local-forage';\nimport {useState} from '@hookstate/core';\nimport Modal from '../../utils/modal';\n\nexport default function ToggleEnableGravatar() {\n  const [gravatarEnabled, setGravatar] = useLocalForage('gravatar-enabled');\n  const state = useState({\n    modalIsOpened: false,\n  });\n  function closeModal() {\n    state.merge({modalIsOpened: false});\n  }\n\n  function openModal(e) {\n    e.preventDefault();\n    state.merge({modalIsOpened: true});\n  }\n\n  if (gravatarEnabled === 'NOT_READY') return null;\n\n  function handleChange() {\n    setGravatar(!gravatarEnabled);\n  }\n\n  return (\n    <div>\n      <div className=\"flex items-center\">\n        <input type=\"checkbox\" checked={!!gravatarEnabled} onChange={handleChange}/>\n        <span className=\"ml-1\">\n          Toggle gravatar\n        </span>\n      </div>\n\n      <div className=\"mt-1\">\n        <button className=\"underline\" onClick={openModal}>\n          Is gravatar safe?\n        </button>\n      </div>\n\n      <Modal isOpened={state.modalIsOpened.get()} close={closeModal}>\n        <div>\n          <h1 className=\"text-xl font-bold\">Is gravatar safe?</h1>\n\n          <div>\n            The short answer if you need 100% security is <b>NO</b>.\n          </div>\n          <div>\n            Otherwise <b>maybe</b>, because you get tracked by gravatar, but they store images for free. Depends on you if are going to accept that risk.\n          </div>\n        </div>\n      </Modal>\n    </div>\n  );\n}","import {AddNewContact} from './contacts/add-new-contact';\nimport {Helmet} from 'react-helmet-async';\nimport {buildPageTitle} from '../page/page-title';\nimport ContactsList from './contacts/ contacts-list';\nimport ContactsStoreLoader from './contacts/contacts-store-loader';\nimport ToggleEnableGravatar from './contacts/toggle-enable-gravatar';\n\nexport default function ContactsPage() {\n  return (\n    <>\n      <Helmet>\n        <title>{buildPageTitle('Contacts')}</title>\n      </Helmet>\n      <div className=\"w-full md:w-1/3 mx-auto pt-4\">\n        <h1 className=\"text-center text-2xl font-bold\">Contacts</h1>\n\n        <div className=\"flex justify-between\">\n          <ToggleEnableGravatar/>\n\n          <AddNewContact/>\n        </div>\n\n        <div>\n          <ContactsStoreLoader>\n            <ContactsList/>\n          </ContactsStoreLoader>\n        </div>\n      </div>\n    </>\n  );\n}","import {MD5 as cryptoMd5} from 'crypto-js';\n\nexport function md5(str) {\n  return cryptoMd5(str).toString();\n}","import {feedBackSuccess} from '../../../lib/feedback/success';\nimport {md5} from '../../../lib/utils/format/md5';\nimport {useEncryptedStorage} from '../../../lib/hooks/use-encrypted-storage';\nimport {useState} from '@hookstate/core';\nimport ContactAvatar from '../../contacts/avatar';\nimport Modal from '../../utils/modal';\n\nexport default function EditProfile() {\n  const [name, setName] = useEncryptedStorage('name');\n  const [email, setEmail] = useEncryptedStorage('email');\n\n  const state = useState({\n    modalIsOpened: false,\n  });\n  function closeModal() {\n    state.merge({modalIsOpened: false});\n  }\n\n  function openModal(e) {\n    e.preventDefault();\n    state.merge({modalIsOpened: true});\n  }\n\n  function updateName(e) {\n    setName(e.target.value);\n  }\n\n  function updateEmail(e) {\n    setEmail(e.target.value);\n  }\n\n  function save(e) {\n    e.preventDefault();\n    closeModal();\n    feedBackSuccess('Profile saved');\n  }\n\n  return (\n    <>\n      <button className=\"underline\" onClick={openModal}>\n        Edit profile\n      </button>\n\n      <Modal isOpened={state.modalIsOpened.get()} close={closeModal}>\n        <form className=\"pure-form pure-form-aligned\" onSubmit={save}>\n          <fieldset>\n            <legend>Edit profile</legend>\n\n            <div className=\"flex justify-center\">\n              <ContactAvatar emailHash={md5(email)} height=\"h-20\" width=\"w-20\"/>\n            </div>\n          </fieldset>\n\n          <div className=\"pure-control-group\">\n            <input name=\"name\" value={name} onChange={updateName} placeholder=\"Name\" className=\"w-full\"/>\n          </div>\n\n          <div className=\"pure-control-group\">\n            <input name=\"email\" value={email} onChange={updateEmail} placeholder=\"Email(optional)\" className=\"w-full\"/>\n            <span className=\"pure-form-message\">Only the email MD5 hash is shared, not your real email. A image can be set for this email on <a className=\"underline\" href=\"https://gravatar.com/\" target=\"_blank\">gravatar.com</a></span>\n          </div>\n\n          <button type=\"submit\" className=\"pure-button pure-button-primary w-full bg-black\">\n            Save\n          </button>\n        </form>\n      </Modal>\n    </>\n  );\n}","export function stringToU8(str) {\n  return new TextEncoder().encode(str);\n}","import {formatToBase64Undetectable} from '../undetectable/format-to-base-64-undetectable';\n\nexport function formatKeyReadable(key) {\n  return formatToBase64Undetectable(key);\n}","import {Helmet} from 'react-helmet-async';\nimport {Link} from 'react-router-dom';\nimport {buildPageTitle} from '../page/page-title';\nimport EditProfile from './home/edit-profile';\nimport ShowSharablePublicKey from './home/show-sharable-public-key';\n\nexport default function HomePage() {\n  return (<>\n    <Helmet>\n      <title>{buildPageTitle('Home')}</title>\n    </Helmet>\n\n    <div className=\"mx-auto md:w-1/3 w-full my-2 flex justify-between\">\n      <Link to=\"/about\">\n        <span className=\"underline\">About</span>\n      </Link>\n\n      <EditProfile/>\n\n      <Link to=\"/backup\">\n        <span className=\"underline\">Backup service</span>\n      </Link>\n    </div>\n\n    <div className=\"flex justify-center\">\n      <ShowSharablePublicKey/>\n    </div>\n  </>);\n}","export default function PageNotFound() {\n  return (\n    <div className=\"text-center text-3xl font-bold\">\n      Page not found\n    </div>\n  );\n}","import {\n  HashRouter,\n} from 'react-router-dom';\n\nexport default function Router({children}) {\n  return (\n    <HashRouter>\n      {children}\n    </HashRouter>\n  );\n}","import * as localforage from 'localforage';\n\nexport function restoreBackupFromJsonFile(file) {\n  return new Promise((resolve) => {\n    const fileReader = new FileReader();\n    fileReader.onload = async (e) => {\n      const json = JSON.parse(e.target.result);\n      await localforage.clear();\n\n      const promises = [];\n\n      for (const k in json) {\n        const v = json[k];\n\n        promises.push(localforage.setItem(k, v));\n      }\n\n      await Promise.all(promises);\n\n      resolve();\n    };\n    fileReader.readAsText(file);\n  });\n}","import {Helmet} from 'react-helmet-async';\nimport {buildPageTitle} from '../page/page-title';\nimport {getItemFromStorage, setStoragePin} from '../../lib/utils/encryption/storage';\nimport {isEmpty} from 'lodash';\nimport {restoreBackupFromJsonFile} from '../../lib/backup/restore-from-json-file';\nimport {useHistory} from 'react-router-dom';\nimport {useKeyPairs} from '../../lib/hooks/use-key-pairs';\nimport {useQueryParams} from '../../lib/hooks/use-query-params';\nimport {useState as useReactState} from 'react';\nimport {useState} from '@hookstate/core';\nimport Modal from '../utils/modal';\nimport logo from '../../assets/enigma-logo.jpg';\n\nexport default function UnlockPage() {\n  const state = useState({backupValue: '', modalOpened: false, pinValue: '', showError: false});\n  const [fileState, setFileState] = useReactState();\n  const history = useHistory();\n  const queryParams = useQueryParams();\n  const {setKeyPair} = useKeyPairs();\n\n  async function unlock(e) {\n    e.preventDefault();\n    const redirectTo = queryParams.get('redirectTo') || '/';\n    setStoragePin(state.pinValue.get());\n\n    try {\n      if (!isEmpty(state.backupValue)) {\n        await restoreBackupFromJsonFile(fileState);\n      }\n      const keyPair = await getItemFromStorage('key-pair');\n      if (isEmpty(keyPair)) {\n        return state.merge({\n          backupFile: null,\n          backupValue: '',\n          modalOpened: false,\n          pinValue: '',\n          showError: true,\n        });\n      }\n      setKeyPair(keyPair);\n\n      history.push(redirectTo);\n    } catch (e) {\n      return state.merge({\n        backupFile: null,\n        backupValue: '',\n        modalOpened: false,\n        pinValue: '',\n        showError: true,\n      });\n    }\n  }\n\n  function updatePinValue(e) {\n    const {value} = e.target;\n    state.merge({pinValue: value});\n  }\n\n  function updateBackupValue(e) {\n    const {value} = e.target;\n    state.merge({backupValue: value});\n    setFileState(e.target.files[0]);\n  }\n\n  function openModal(e) {\n    e.preventDefault();\n    state.merge({modalOpened: true});\n  }\n\n  function closeModal() {\n    state.merge({modalOpened: false});\n  }\n\n  return (\n    <>\n      <Helmet>\n        <title>{buildPageTitle('Unlock')}</title>\n      </Helmet>\n      <div className=\"w-full md:w-1/3 mx-auto\">\n        <div className=\"flex justify-center\">\n          <img src={logo} alt=\"enigma\"/>\n        </div>\n\n        <form className=\"pure-form\" onSubmit={unlock}>\n          <fieldset>\n\n            <div className=\"pure-control-group py-2\">\n              <input type=\"password\" value={state.pinValue.get()} onChange={updatePinValue} className=\"w-full\" placeholder=\"Enter your PIN to continue\"/>\n              {\n                state.showError.get() && <span className=\"pure-form-message text-red-500\">Invalid PIN</span>\n              }\n            </div>\n\n            <button type=\"submit\" className=\"pure-button pure-button-primary w-full bg-black font-bold\" disabled={isEmpty(state.pinValue.get())}>\n              Unlock\n            </button>\n\n            <div className=\"pure-control-group pt-4\">\n              <div className=\"flex justify-end\">\n                <button onClick={openModal} className=\"underline\">\n                  Restore from backup\n                </button>\n              </div>\n              <Modal isOpened={state.modalOpened.get()} close={closeModal}>\n                <h1 className=\"font-lg font-bold\">Restore from backup</h1>\n\n                <p>Select a backup file:</p>\n                <input type=\"file\" accept=\".json\" value={state.backupValue.get()} onChange={updateBackupValue}/>\n\n                <div className=\"pt-2\">\n                  <span className=\"font-bold\">Warning</span>, restoring data from a backup, <em>will override the current data</em>\n                  <div>\n                    Make sure, that you have a <b>backup of the current data</b>.\n                  </div>\n                  <div>\n                    If you have a backup, then it's safe.\n                  </div>\n                </div>\n              </Modal>\n            </div>\n          </fieldset>\n        </form>\n      </div>\n    </>\n  );\n}","import {\n  useLocation,\n} from 'react-router-dom';\n\nexport function useQueryParams() {\n  return new URLSearchParams(useLocation().search);\n}","import 'purecss';\nimport 'react-toastify/dist/ReactToastify.css';\nimport {AppSetup} from './components/page/app-setup';\nimport {\n  Route,\n  Switch,\n} from 'react-router-dom';\nimport {ToastContainer} from 'react-toastify';\nimport {UnlockedRoute} from './components/page/unlocked';\nimport AboutPage from './components/pages/about';\nimport AppLayout from './components/page/layout';\nimport BackupPage from './components/pages/backup';\nimport ContactPage from './components/pages/contact';\nimport ContactsPage from './components/pages/contacts';\nimport HomePage from './components/pages/home';\nimport PageNotFound from './components/pages/page-not-found';\nimport PageTitle from './components/page/page-title';\nimport Router from './components/config/router';\nimport UnlockPage from './components/pages/unlock';\n\nexport default function App() {\n  return (\n    <>\n      <PageTitle>\n        <Router>\n          <AppLayout>\n            <Switch>\n              <UnlockedRoute path=\"/\" exact>\n                <HomePage/>\n              </UnlockedRoute>\n\n              <UnlockedRoute path=\"/about\">\n                <AboutPage/>\n              </UnlockedRoute>\n\n              <UnlockedRoute path=\"/backup\">\n                <BackupPage/>\n              </UnlockedRoute>\n\n              <UnlockedRoute path=\"/contacts/:id\">\n                <ContactPage/>\n              </UnlockedRoute>\n\n              <UnlockedRoute path=\"/contacts\">\n                <ContactsPage/>\n              </UnlockedRoute>\n\n              <Route path=\"/unlock\">\n                <AppSetup>\n                  <UnlockPage/>\n                </AppSetup>\n              </Route>\n\n              <Route path=\"*\">\n                <PageNotFound/>\n              </Route>\n            </Switch>\n          </AppLayout>\n        </Router>\n      </PageTitle>\n      <ToastContainer/>\n    </>\n  );\n}","const reportWebVitals = (onPerfEntry) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({getCLS, getFID, getFCP, getLCP, getTTFB}) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import './index.css';\nimport './tailwind.css';\nimport * as serviceWorkerRegistration from './serviceWorkerRegistration';\nimport App from './app';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n    <React.StrictMode>\n      <App />\n    </React.StrictMode>,\n    document.getElementById('root'),\n);\n\nserviceWorkerRegistration.register();\n\nreportWebVitals();\n"],"sourceRoot":""}